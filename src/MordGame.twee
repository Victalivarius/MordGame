:: StoryTitle
MordGame


:: StoryData
{
  "ifid": "251AC418-99DA-44D3-A910-714DEAB8770B",
  "format": "SugarCube",
  "format-version": "2.37.3",
  "start": "Intro",
  "tag-colors": {
    "failtry": "red",
    "success": "green"
  },
  "zoom": 0.6
}


:: "Any idea where she could be?" {"position":"1525,1350","size":"100,100"}
<<say "belle" "Isn't Diana a princess name?" "images/characters/belle_smile.png">>
<<linkreplace " Continue ▶ ">>
<<say "amber" "Huh, I've never heard of a princess Diana, but it would be a nice princess name" "images/characters/amber_thinking.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "I want to be a princess to ride horses in a big dress!" "images/characters/belle_owo.png">>
<<linkreplace " Continue ▶ ">>
<<say "mordred" "You could ride Tena in a big dress" "images/characters/mordred_cute.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "you're a genius dad!...do you think Diana is the kind of princess that rides fancy rotes too?" "images/characters/belle_owo.png">>
<<linkreplace " Continue ▶ ">>
<<say "mordred" "Maybe...wait, I know where she might be." "images/characters/mordred_thinking.png">>
<<set $clueDiana=true>>
[[To Metis]]
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>


:: "David was sleeping at home, maybe he didn't know you would be here?" {"position":"1550,1075","size":"100,100"}
<<say "belle" " YES! I smell like fish, the cats will love me more!" "images/characters/belle_happy.png">>
[["I guess..."]]
:: "David was sleeping at home. Let's go ask him. AND you can take a warm bath." {"position":"1550,950","size":"100,100"}
<<say "belle" "NAEE NOOOOO" "images/characters/belle_screaming.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "I smell like fish, the cats will love me more!" "images/characters/belle_happy.png">>
[["I guess..."]]
<</linkreplace>>


:: "Have you seen Otta?" {"position":"2650,3075","size":"100,100"}
<<say "neo" "Otta...famous gym coach and psychologist, nah haven't seen 'er since she left me in charge of Dot." "images/characters/neo_thinking.png">>
<<linkreplace " Continue ▶ ">>
<<say "neo" "..." "images/characters/neo_neutral.png">>
<<linkreplace " Continue ▶ ">>
<say "neo" "Dot doesn't need to be watched anyway, he`s the smartest kid I know. You know it" "images/characters/neo_happy.png">>
<<linkreplace " Continue ▶ ">>
He gives you a playful hit in the shoulder.
<<say "neo" "you should really be proud of them. Man, they're so little and talk so fluently already!" "images/characters/neo_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "what is...flentl...flue...fluently??" "images/characters/belle_thinking.png">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "he said we talk clearly, Belle" "images/characters/dot_thinking.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "...aaaaaahhh....abosolutely!!" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "neo" "haha!" "smile">>
[[Continue->AnimalMaster]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>

:: "Heather, have you seen Otta?" {"position":"2900,2700","size":"100,100"}
Heather raises an eyebrow at Coco.

<<linkreplace " Continue ▶ ">>
<<say "coco" "aah...no? I don't think so." "neutral">>
<<linkreplace " Continue ▶ ">>
<<say "mordred" "(everyone is being strangely unhelpful)" "suspicious">>
<<return>>
<</linkreplace>><</linkreplace>>

:: "Hello, Heather!" {"position":"950,1475","size":"100,100"}
<<say "heather" "Hello, Mordred, how are you?" "images/characters/heather_happy.png">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "I'm fine, what are you doing?" "neutral">>
<<linkreplace " Continue ▶ ">>
<<say "heather" "Oh I'm just watering the crops. But I just came back from buying some candles." "images/characters/heather_neutral.png">>
<<linkreplace " Continue ▶ ">>
  <<say "heather" "Because the portal closer to Nico's is not working, I'll repair it later." "images/characters/heather_thinking.png">>
<<linkreplace " Continue ▶ ">>
  <<say "heather" "Then I'm going to the Dome for launch day, what about you?" "images/characters/heather_smile.png">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "Going to pick up Belle from Nico's, then I'll see. Let me know if you need any help." "happy">>
<<linkreplace " Continue ▶ ">>
  <<say "heather" "Sure, thanks! I should be fine, I have everything for the portal charcoal, ashes, sulfur and wax" "images/characters/heather_smile.png">>
  <<return>>
  <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: "I guess..." {"position":"1675,1025","size":"100,100"}
<<say "mordred" "She'll do it sooner or later" "thinking">>

<<linkreplace " Continue ▶ ">>
    <<pickup $backpack "belle" 1>>
    Belle joins your party!

Saying goodbye to Belle, Nico enters his house when...
<<linkreplace " Continue ▶ ">>
<<link "MEOW">>
<<run sounds.meow.currentTime = 0; sounds.meow.play();>>
<</link>>
<<linkreplace " Continue ▶ ">>
One of the cats comes out of the house and jumps on Belle, knocking her to the floor, but she immediately gets back up laughing, hugging the cat.
<<linkreplace " Continue ▶ ">>
<<say "belle" "Loretta!..what are you doing here and not with David?" "images/characters/belle_thinking.png">>
  Loretta is white with black spots, she's a bit fat and has a very fluffy tail. She nuzzles Belle's facecheek and gives her a good lick too.
<<linkreplace " Continue ▶ ">>
 <<say "nico" "Well, she must have escaped from David or something." "thinking">>
 <<linkreplace " Continue ▶ ">>
 <<say "nico" "Well, I have many fish to prepare for dinner! see you two later." "happy">>
 He pats Mordred in the shoulder before finally leaving to the inside of his house and closing the door behind him.

 [[Go home->CatAdventure1]]
 <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>><</linkreplace>><</linkreplace>>


:: "I just went out to get the ingredients" {"position":"2075,2325","size":"100,100"}
<<say "herb" "fff....yeah, yeah, I'm sorry. Something happened, I only got the sugar flowers" "shame">>
<<linkreplace " Continue ▶ ">>
	<<say "herb" "something came up and...ah, Bastet will understand. I'm sorry you had to do my job." "sadsmile">>
	<<linkreplace " Continue ▶ ">>
		<<say "mordred" "(There were no sugar flowers in the list Bastet gave me...)" "suspicious">>
		<<linkreplace " Continue ▶ ">>
			<<say "mordred" "It's okay. Everything alright here?" "thinking">>
			<<linkreplace " Continue ▶ ">>
				<<say "herb" "yeah, yeah, dad is having a bad day." "shame">>
				<<linkreplace " Continue ▶ ">>
					<<say "angelus" "I'm okay." "sad">>
					<<linkreplace " Continue ▶ ">>
						<<say "herb" "Come on, there will be cake at the dome, and the fireplace is on inside." "sad">>
<!-- Este div DEBE estar fuera del <<if>> para que <<replace>> lo pueda encontrar -->
<div id="givechocolate"></div>

<<if $backpack.has("chocolate")>>
	<<linkreplace "I have something that might cheer you up.">>
		<<replace "#givechocolate">>
			<<run $backpack.drop("chocolate", 1)>>
			<p>You give Angelus the chocolate.</p>
			<<linkreplace " Continue ▶ ">>
				<<say "angelus" "A gift? what's this?" "curious">>
				<<linkreplace " Continue ▶ ">>
					<<say "herb" "You have lived like 700 years and don't know what chocolate is?" "joy">>
					<<linkreplace " Continue ▶ ">>
						<<say "mordred" "Try it!" "smile">>
            <<linkreplace "Cotinue">>
              Angelus unwraps the chocolate bar with his long fingers and gives it a bite, for a few seconds he's munching on it...
              <<linkreplace " Continue ▶ ">>
                <<say "angelus" "Hey I've eaten this before" "eyebrow">>
                He continues munching. Herb laughs out loud.
                <<linkreplace " Continue ▶ ">>
                  <<say "angelus" "Thank you, Mord. I do feel better.">>
                  <<linkreplace " Continue ▶ ">>
                    <<say "mordred" "and there will be more if you come over for launch day." "happy">>
                    <<linkreplace " Continue ▶ ">>
                      <<say "angelus" "Okay. You win, chocolate is worth living for." "sadsmile">>
						<p>The three of you make your way back to Bastet's.</p>
						[[Bastet's->ToTheDome]]
            		<</linkreplace>>
				<</linkreplace>>
        		<</linkreplace>>
				<</linkreplace>>
        	<</linkreplace>>
					<</linkreplace>>
				<</linkreplace>>
			<</linkreplace>>
		<</replace>>
	<</linkreplace>>
<</if>>

<!-- Puedes agregar una ruta alternativa para cuando NO tiene chocolate -->
<<if !$backpack.has("chocolate")>>
	<<linkreplace "Yes, come over, it's too cold out here.">>
		<<say "mordred" "Yes, come over, it's too cold out here." "smile">>
		<<linkreplace "Continue ▶">>
			<<say "angelus" "....I'll go with you later, okay? I really need to be alone." "sadsmile">>
			<<linkreplace "Continue ▶">>
				<p>Herb hesitates, before finally answering:</p>
				<<say "herb" "...Alright. See you later, dad. Let's go Mord." "sad">>
				<p>The two of you make your way back to Bastet's.</p>
				[[Bastet's->ToTheDome]]
			<</linkreplace>>
		<</linkreplace>>
	<</linkreplace>>
<</if>>

	

					<</linkreplace>>
				<</linkreplace>>
			<</linkreplace>>
		<</linkreplace>>
	<</linkreplace>>
<</linkreplace>>

:: "Let's go get Sabrina" [success] {"position":"1725,1625","size":"100,100"}
Amber leads them both to the tree. Sabrina, the skinny, mustard-colored cat, is chilling on one of the highest branches, looking grumpy.
When she sees them approaching, she begins to meow repeatedly, although she doesn't seem that stressed about being up there...
Amber explains that she has tried everything but she won't come down.
<<linkreplace " Continue ▶ ">>
<<say "mordred" "...maybe there's something we can use to make her come down..." "thinking">>
<<linkreplace " Continue ▶ ">>
<<if $backpack.has("belle")>>
	<div id="belleArea">
		<<link "Lift Belle">>
			<<replace "#belleArea">>
				<p>You pick up Belle from under the arms and lift her.</p>
				[[Smells like fish...->FoundSabrina]]
			<</replace>>
		<</link>>
	</div>
<</if>>

<</linkreplace>>

<</linkreplace>>

:: "Lissa?" {"position":"2075,1950","size":"100,100"}
You call out, and followed you hear things falling and quick steps coming from upstairs.
 Lissa appears at the top of the stairs, you catch the shines of glitter on her face.
<<linkreplace " Continue ▶ ">>
  <<say "lissa" "M-Mordred? What are you doing here?" "surprised">>
  <<linkreplace " Continue ▶ ">>
    <<say "mordred" "Bastet needs some ingredients for a cake..." 'suspicious'>>
    <<linkreplace " Continue ▶ ">>
      <<say "lissa" "Oh take anything you need from the kitchen, don't be afraid to loo around...it's so dark there!" "nervious">>
      <<set $lightsOn = true>>
      <<linkreplace " Continue ▶ ">>
        Lissa comes down the stairs and turns the lights on.
        <<linkreplace " Continue ▶ ">>
        <<say "lissa" "Gosh! Hah...I was doing some...arts and crafts and completely lost track of time." "nervious">>
        <<linkreplace " Continue ▶ ">>
          <<say "mordred" "Arts and crafts?" "suspicious">>
          <<linkreplace " Continue ▶ ">>
          <<say "lissa" "Yes, as usual, I guess you got Quiroga's keys? I told him to leave for a while so I could work in peace." "nervious">>
          <<linkreplace " Continue ▶ ">>
            <<say "mordred" "Yes, he gave them to me." "suspicious">>
            <<linkreplace " Continue ▶ ">>
          [["Okay, I'll just grab some flour and sugar and leave."->Lissa's kitchen]]
          [["What are you working on?"]]
  <</linkreplace>>   <</linkreplace>>   <</linkreplace>>   <</linkreplace>>   <</linkreplace>>   <</linkreplace>>   <</linkreplace>>   <</linkreplace>>   <</linkreplace>>

:: "Sure, what do we do?" {"position":"1600,2600","size":"100,100"}
<<say "belle" "I don't know, let's go outside and see what or who we find!" "images/characters/belle_smile.png">>
<<linkreplace " Continue ▶ ">>
 For a moment, you wonder to yourself how Belle turned out this way. Neither you or Otta are that extroverted...but she grew up surrounded by such a big extended family, that maybe that's the reason.
 Together;you go to the backyard looking for adventure.
 [[Backyard->DotsHomework]] 
 <</linkreplace>>

:: "Sure, you want to go see the animals?" {"position":"1850,2600","size":"100,100"}
<<say "belle" "a b s o l u t e l y" "images/characters/belle_screaming.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "did you see that? I learnt that word this morning ABSOLUTELY" "images/characters/belle_mischevious.png">>
<<linkreplace "What does it mean?">>
<<say "belle" "It means..." "images/characters/belle_proud.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "BIG YES!!!!" "images/characters/belle_screaming.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "I'm boreedd, let's go now" "images/characters/belle_neutral.png">> 
 [[Backyard->DotsHomework]] 

<</linkreplace>> <</linkreplace>><</linkreplace>> <</linkreplace>>

:: "Thank you! ,Take a picture, Dot!" {"position":"2950,3075","size":"100,100"}
Lesle visibly blushes.
<<say "lesle" "<p class='asl'>Thank you. We don't know each other that well, but your wedding was so beautiful, had to draw something from it</p>" "blushing">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "haha! no idea what you're saying!" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "lesle" "<p class='asl'>I wish I can have a wedding like that someday.</p>" "neutral">>
<<linkreplace " Continue ▶ ">>
<<say "lesle" "<p class='asl'>But I'll probably never marry cause I killed a man.</p>" "neutral">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "um...that's cool" "eyebrow">>
Dot takes a picture of the drawing before you all say goodbye.
[[Back Garden]] 
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>

:: "Wait...did you draw that from memory or?" {"position":"3025,2950","size":"100,100"}
Lesle takes out a polaroid photo and gives it to you. In the foreground, Johnny takes a selfie at your wedding with Otta...sticking out his tongue and covering half your face with his mohawk. Lesle was able to reproduce your face from memory pretty well.
[["Thank you! ,Take a picture, Dot!"]]
[["wow...I don't know what to say, thank you!"->"Thank you! ,Take a picture, Dot!"]]

:: "We should help them, there might be a lot to set up" {"position":"1725,2600","size":"100,100"}
Belle stares at you blankly for an uncomfortable period of time. 
<<linkreplace " Continue ▶ ">>
<<say "belle" "You're the boring-est dad that has ever been" "images/characters/belle_seriously.png">>
<<linkreplace "I just thought they might need hel...">>
<<say "belle" "They have enough help, dad, come on!" "images/characters/belle_screaming.png">>
 [[Backyard->DotsHomework]] 
 <</linkreplace>> <</linkreplace>>


:: "What are you up to?" {"position":"2900,2825","size":"100,100"}
<<say "heather" "Not much, I'm making up some new potions" "images/characters/heather_smile.png">>
<<linkreplace " Continue ▶ ">>
<<say "coco" "and tea mixes!" "images/characters/coco_smile.png">>
<<linkreplace " Continue ▶ ">>
<<say "heather" "Butterfly pea flower, cinnamon, and sugar is our star tea!, but we want to make a new one" "images/characters/heather_proud.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "yum!!" "images/characters/belle_happy.png">>
<<return>>
<</linkreplace>><</linkreplace>><</linkreplace>>


:: "What are you working on?" {"position":"2200,1925","size":"100,100"}
<<say "Lissa" ".........." "surprised">>
<<linkreplace " Continue ▶ ">>
<<say "Lissa" "um yeah take anything you need from the kitchen!!" "smile">>
 [["O..okay, I'll just grab some flour and sugar and leave...."->Lissa's kitchen]]
<</linkreplace>>


:: "Why do you have a magic door here?" {"position":"1100,1850","size":"100,100"}
<<say "malik" "Long time no see Mordred...we met once, right? I remember you." "smile">>
<<linkreplace " Continue ▶ ">>
<<say "malik" "I'm travelling, now that I'm half a god, I can do pretty much everything." "images/characters/malik_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "malik" "I'm also selling magic items, if any of you happen to be interested." "images/characters/malik_smile.png">>
<<linkreplace " Continue ▶ ">>
<<say "amber" "..." "owo">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "Do you have any cat locators?" "images/characters/belle_whisper.png">>
<<linkreplace " Continue ▶ ">>
<<say "malik" "Not really but this one got here this morning." "images/characters/malik_idk.png">>
Malik turns around, inside the fancy yet messy room, Penelope is spinning in the turntable's vynil.
[[Found Penelope]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: "Wouldn't it be easier to ask David what's going on?" {"position":"1775,1350","size":"100,100"}
<<say "amber" "Well, maybe." "thinking">>
<<linkreplace " Continue ▶ ">>
You three make your way back to Heather's cabin. Where David still sleeps, it looks like the couch is absorbing him, they're becoming one, in the best possible way.
[[Try to wake him up]]
<<return>>
<</linkreplace>>


:: "You were supossed to look after Dot" {"position":"2525,3075","size":"100,100"}
<<say "neo" "Mordred....there`s no watching him, he`s the smartest kid I know. You know it" "smile">>
<<linkreplace " Continue ▶ ">>
He gives you a playful hit in the shoulder.
<<say "neo" "you should really be proud of them. Man, they're so little and talk so fluently already!" "happy">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "what is...flentl...flue...fluently??" "thinking">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "he said we talk clearly, Belle" "seriously">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "...aaaaaahhh....abosolutely!!" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "neo" "haha!" "smile">>
[[Continue->AnimalMaster]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: AnimalMaster {"position":"2600,3200","size":"100,100"}
<<say "belle" "Neo you're the animal master right?" "happy">>
<<linkreplace " Continue ▶ ">>
<<say "neo" "Yup, I'm a biologist." "smile">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "can you show us all the animals?, I met a lot of cats today, I need MORE" "screaming">>
<<linkreplace " Continue ▶ ">>
<<say "neo" "heh..sure thing. There's not that many of them. it won't take long." "happy">>
<<linkreplace " Continue ▶ ">>
Neo approaches the cow and pets its forehead.
<<say "neo" "This is Joy. Frau named her after the protagonist of SuperSunny...she was the first animal I was able to completely cure of the mutation.">>
Belle wants to pet the cow, but the smell of the stable makes her a little repulsive. She approaches anyway; Joy lowers her head to eat some hay, and Belle takes the opportunity to pet her.
<<linkreplace " Continue ▶ ">>
You continue seeing animals, the cat Mean, the goose Winner, the mutant hen Violet, Belle pets each of them (except the goose, which scares her and she calls it 'ethikai').
<<linkreplace " Continue ▶ ">>
<<say "neo" "and last but not least, Looser the goat." "smile">>
<<linkreplace " Continue ▶ ">>
Belle approaches the goat, fearless of it. She picks up some grass and feeds him. Looser accidentally licks her finger and she laughs.
<<say "belle" "That tickles...why did you give him that awful name tho?...he looks more like...Buttercup, to me." "seriously">>
<<linkreplace " Continue ▶ ">>
<<say "neo" "He was the first animal brought to The Dome. I named him after Lucius" "laughing">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "aaah..." "seriously">>
Belle remembers how Malik named his bald cat Fuzzy, and still can't understand why it's funny.
You have met all animals and Belle finally decides that she has seen enough furry fellas for today.
 [[Gardens]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>

:: Back Garden {"position":"2750,2950","size":"100,100"}
The three of them head deeper into the gardens until they reach an area that Mordred will remember as the place where she once did something with Otta. There's plenty of sunlight here.
On a bench, sits Lesle, the Shades' drummer, with his blackboard, bobbing his head to a rhythm that seems to be only in his head. Next to him is Johnny's friend, Tony, playing a slow tune in his guitar, and adjusting the strings tuning here and there.
Strange, he's here instead of the third member of The Shades.
[[Tony, Have you seen Otta?]]
[[Lesle, Have you seen Otta?]]
[[Gardens]]

:: Back to Bastet's {"position":"2025,1650","size":"100,100"}
You walk back to Bastet's cabin, the snow crunches under your feet.
<<linkreplace " Continue ▶ ">>
<<say "mordred" "(Why is everyone acting so weird?...)" "thinking">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "(No, wait, that's just how they are....but Lissa was...)" "thinking">>
  <<linkreplace " Continue ▶ ">>
 Before Mordred has time to think anything else, once again, he hears murmurs in the distance.
 [[That must be Herb]]
 <</linkreplace>><</linkreplace>><</linkreplace>>

::That must be Herb 

You decide that it's better to come back not only with the ingredients but Herb too...what if he already had the ingredients and you had to go through all this trouble for nothing?...better not to think about that.
You follow the sound of the murmurs, until you finally recognize a voice;
<<linkreplace " Continue ▶ ">>
<<say "herb" "Cheer up,dad, maybe if you come inside you'll feel better, it's hella cold here." "worried">>
<<linkreplace " Continue ▶ ">>
<<say "angelus" "....">>
<<linkreplace " Continue ▶ ">>
The worry in Herb's face is clear, but it akwardly fades away when he spots you.
<<say "herb" "Heey! Mordred, what you doing out here?" "smile">>
[["Is everything alright?"->"I just went out to get the ingredients"]]
[["I just went out to get the ingredients"]]
<</linkreplace>><</linkreplace>><</linkreplace>>

:: Barn {"position":"2600,2950","size":"100,100"}
You walk past the lake to the animal area. Some are grazing outside. There aren't many, a calf, a goat, a cat, and a goose... you hear someone singing inside the barn.
<<linkreplace " Continue ▶ ">>
<<say "neo" "Well, they encourage your complete cooperation...🎶" "sing">>
He's singing out loud while milking a cow. Shortly ater he gets back up and notices you.
<<linkreplace " Continue ▶ ">>
<<say "belle" "ewwwwwwww!!" "seriously">>
<<linkreplace " Continue ▶ ">>
<<say "neo" "what?, It'll be clean soon, you drink this milk with cocoa!" "laughing">>
<<linkreplace " Continue ▶ ">>
[["You were supossed to look after Dot"]]
[["Have you seen Otta?"]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Basement {"position":"1450,2125","size":"100,100"}
After leaving the note in a visible place, Mordred goes to the basement, making sure that the portal is ready to go. 
Shortly after, David, Amber and Belle come down with the cats all with their corresponding leads.

 [[Go to Aquari's snowy forest->Snowy forest]]


:: Bastet's {"position":"1700,2125","size":"100,100"}
Bastet's and  Herb's house is a warm and cozy cabin that they put together themselves. The fireplace is on, and there's a strong smell of...cake?
As you all enter, Bastet greets you with a big smile and open arms. The cats immediately scatter around the living room, exploring every corner.
<<linkreplace " Continue ▶ ">>
<<say "bastet" "Ah, I was waiting for ya'll" "happy">>
<<linkreplace " Continue ▶ ">>
 Bastet gives Mordred a quick hug, followed by Belle. Then, David and Amber start to introduce all the cats to her, she is delighted to see them all.
<<linkreplace " Continue ▶ ">>
  <<say "bastet" "They behave so well!" "wow">>
<<linkreplace " Continue ▶ ">>
  <<say "bastet" "but sadly, I have to leave to the dome soon. I need to take this cake there, it's for the launch day celebration." "nervious">>
  <<linkreplace " Continue ▶ ">>
    <<say "belle""Aw...the cake isn`t for us?..." "images/characters/belle_cute.png">>
    <<linkreplace " Continue ▶ ">>
      <<say "bastet" "No, but we can make another one sometime, okay?" "happy">>
      <<linkreplace " Continue ▶ ">>
        <<say "belle" "okaaay, auntie" "images/characters/belle_sad.png">>
        <<linkreplace " Continue ▶ ">>
          <<say "bastet" "But...I don't think one cake will be enough, and I don't have any more ingredients." "nervious">>
          <<linkreplace " Continue ▶ ">>
            <<say "bastet" "Herb was going to get some more but he's not back yet, I'm worried, and I need to leave soon." "nervious">>
            <<linkreplace " Continue ▶ ">>
              <<say "amber" "Oh. we'll help you, we can get the ingredients. We need to go back to the Dome later too." "happy">>
              <<linkreplace " Continue ▶ ">>
                <<say "bastet" "Oh, that would be great! I need flour, sugar, eggs, and butter." "happy">>
                You manage to convince everyone to stay here and not be cold, that you'll go out get the ingredients and look for Herb.
                <<drop $backpack 'belle' 1>>
                [[Back outside->Snowy forest2]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>> <</linkreplace>>

:: Bedroom {"position":"850,925","size":"100,100"}
<<if !$readNote || !$dressed >>
Everything's in order, except for the bed. Did Otta tidy everything up before leaving?

[[Wardrove |Wardrove]]
<<linkreplace "Living room">>
<<say "mordred" "I should get dressed before and check if Otta left a note." "pajamasthinking">>
<</linkreplace>>
<<else>>
<<say "mordred" "Time for breakfast" "happy">>
[[Wardrove |Wardrove]]
[[Stairs, Living room |Living Room]]
<</if>>


:: Call him softly [failtry] {"position":"700,1400","size":"100,100"}
<<say "david" "......." "images/characters/david_asleep.png">>
nothing.
<<return>>

:: Can you just help me? {"position":"2800,1925","size":"100,100"}
<<say "mordred" "Can you just help me?" "neutral">>
 You explain that Bastet needs to finish that cake for the launch day, but that there's no ingredients, and that Herb should have gone to get them but he hasn't come back yet.
<<linkreplace " Continue ▶ ">>
<<say "grandad" "We'll help." "neutral">>
<<linkreplace " Continue ▶ ">>
  <<say "grandad" "If you prove your strength." "neutral">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "What?..." "nervious">>
  Quiroga was taking out his housekeys, but he saves them again.
  Grandad walks into the forest and quickly comes back with a big rock, it's about the size of your ribcage, he throws it to you. 
<<linkreplace " Continue ▶ ">>
  <<say "grandad" "Lift it.Prove you're not a pussy." "neutral">>
  ready?
  <<linkreplace " Continue ▶ ">>
    GO 
<<clickbar 25 "Good enough">>
[["I can't do it!"->Good enough]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: CatAdventure1 {"position":"1600,1575","size":"100,100"}
Mordred and Belle walk through Metis in the direction of their home. 
 She hops the whole way, Loretta bounces in her arms.
<<linkreplace " Continue ▶ ">>
 But suddenly!
  <<say "amber" "Mordred!,Belle!" "panic">>
    Amber huffs, she seems to be running around for a while, her hair is a mess, her face sweaty.
<<linkreplace " Continue ▶ ">>
  <<say "amber" "The cats! I can't find them anywhere...and I think Sabrina is stuck in a tree again">>
  <<linkreplace " Continue ▶ ">>
<<say "belle" "Wh-what?!" "images/characters/belle_screaming.png">>
  <<linkreplace " Continue ▶ ">>
<<say "belle" "We gotta help her, dad! we already found Loretta, so that's something." "images/characters/belle_sad.png">>
[["You need to take a bath first" ->CatAdventure2_bath]]
[["We'll do it!" ->CatAdventure2]]
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>

:: CatAdventure2 {"position":"1650,1350","size":"100,100"}
<<say "mordred" "Yeah, come on, I guess your fishy smell will help find them." "laughing">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "Yeah!! You got it! This is the best day to be dirty!" "images/characters/belle_smile.png">>
Amber laughs, but she's too nervous to do it sincerely.
<<linkreplace " Continue ▶ ">>
<<say "amber" "Where should we go first?">>
[["I heard a meow in the way here"->Investigate]]
[["Let's go get Sabrina"]]
[["Wouldn't it be easier to ask David what's going on?"]]
<</linkreplace>>
<</linkreplace>>

:: CatAdventure2_bath {"position":"1775,1500","size":"100,100"}

<<say "belle" "No way!!! This is the best day to be dirty!" "images/characters/belle_seriously.png">>
Amber laughs, but she's too nervous to do it sincerely.
<<linkreplace " Continue ▶ ">>
<<say "amber" "Where should we go first?">>
[["I heard a meow in the way here"->Investigate]]
[["Let's go get Sabrina"]]
[["Wouldn't it be easier to ask David what's going on?"]]
<</linkreplace>>


:: Classroom {"position":"2400,3000","size":"100,100"}
<<say "belle" "I like our classrooms better!" "neutral">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "I like it better when we're out of the classroom" "happy">>
<<linkreplace " Continue ▶ ">>
There's something in the blackboard, it says "10/20XX"
<<linkreplace " Continue ▶ ">>
<<say "dot" "why would they write that? isn't Aquari in the 2060's?" "thinking">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "dunno" "neutral">>
<<return>>
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Click speed {"position":"450,575","size":"100,100"}
<<clickbar 5 200 "TestRoom">>


:: Could you help Nina with this? {"position":"2150,2975","size":"100,100"}
<<drop $backpack "book" 1>>
    Jim takes the book from your hands, his mechanical hands turning in a circle to turn it right side up.
        <<linkreplace " Continue ▶ ">>
    <<say "jim" "Ah, Miss Nina needs some help understanding the language?">>
    <<linkreplace " Continue ▶ ">>
    He reads out loud;
    <<say "jim" "Genetics...that sounds hard!">>
    <<linkreplace " Continue ▶ ">>
<<say "jim" "I will go help her at once. Thank you for letting me know, Mordred.">>
<<set $helpedNina= true>>
<<linkreplace "No problem">>
<<say "mordred" "No, thank you" "smile">>
[[Go back->Upstairs]]

<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Crops {"position":"2750,2700","size":"100,100"}
As she walks through the fields, Belle makes faces at the sunflowers; they're bigger than her head.
In the distance, you see Heather again, accompanied by her girlfriend.
How strange, has she been in the fields all day today, first at home and now here?
Together, they're collecting something. It's unclear, but Heather gives Coco herbs to smell, then puts them in a basket full of jars, in the right one, each labeled with Heather's handwriting.

<<linkreplace " Continue ▶ ">>
<<say "dot" "Hello, aunties!" "images/characters/dot_smile.png">>
<<linkreplace " Continue ▶ ">>
<<say "coco" "hey, how you doing, kids?" "images/characters/coco_smile.png">>
Belle runs up to Heather and jumps into a surprise hug. Heather wobbles but manages to hold on to her cane. She laughs despite the intensity and hugs her back.
<<linkreplace " Continue ▶ ">>
<<say "belle" "Aunt Heather, I made this today for you!" "images/characters/belle_smile.png">>
Belle takes out a crumpled piece of paper, unwrinkles it, and straightens it up a bit as if nothing had happened.
<<linkreplace " Continue ▶ ">>
<<say "belle" "Sorry! I drew it in Grandpa Nico's notebook when we were fishing this morning, and... I don't think it survived the trip, but... you can still see it?" "images/characters/belle_thinking.png">>
Heather takes the drawing. Coco leans over to look over her shoulder with a smile.
<<linkreplace " Continue ▶ ">>
<<say "heather" "The stinkhorn mushroom, like I taught you" "images/characters/heather_blushing.png">>
<<linkreplace " Continue ▶ ">>
<<say "coco" "You named him Rony?" "images/characters/coco_laughing.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "yes because me and grandpa are going to visit it tomorrow again!" "images/characters/belle_smile.png">>

[["Heather, have you seen Otta?"]]
[["What are you up to?"]]

<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>

:: DAVID!! [failtry] {"position":"450,1400","size":"100,100"}
<<say "david" "........" "images/characters/david_asleep.png">>
Still sleeping.
<<return>>


:: Dome Plaza {"position":"2600,2700","size":"100,100"}
The dome plaza is circular, and more than a place to socialize, 
it's a place to meet quickly or simply move from one side to the other. In the middle is a huge statue of Meriem Wesscoff, grandmother of Lucius.
<<return>>

:: Dome1 {"position":"2100,2725","size":"100,100"}
<<say "mordred" "I wonder where Otta is..." "thinking">>
From now on, you're free to look around the Dome.
[[Meriem's mansion]]
[[Dome Plaza]]
[[Gardens]]
[[To the hangar]]


:: DotsHomework {"position":"1725,2725","size":"100,100"}
Belle pulls you by your arm and takes you outside through the back door Right there in the deck, you see Dot sitting in one of the tables, 
grabbing his head over his homework notebook. 

<<linkreplace " Continue ▶ ">>
  <<say "belle" "Dot!!" "images/characters/belle_screaming.png">>
<<linkreplace " Continue ▶ ">>
  <<say "dot" "NO, you're the last one I need!" "frustrated">>
  Belle gasps loudly.
  <<linkreplace " Continue ▶ ">>
    <<say "dot" "Don't bother me I have to finish this homework for tomorrow and I...I can't figure it out!" "cry">>
    <<linkreplace "It's okay, we'll help you.">>
      <<say "mordred" "It's okay, we'll help you." "smile">>
    <<linkreplace " Continue ▶ ">>
    <<say "dot" "T-thanks dad but tell Belle to not make fun of me." "embarassed">>
    <<linkreplace " Continue ▶ ">>
      <<say "belle" "I won't! You're smarter than me, that time I made fun of you, I was joking" "images/characters/seriously.png">>
    <<linkreplace " Continue ▶ ">>
      <<say "dot" "I..know but I keep getting stuck in easy things." "sad">>
      <<linkreplace " Continue ▶ ">>
        <<say "mordred" "That's alright, we all get stuck sometimes" "smile">>
        <<linkreplace " Continue ▶ ">>
          <<say "belle" "woah, dad look at you all wise and stuff" "images/characters/belle_owo.png">>
          <<linkreplace " Continue ▶ ">>
            <<say "dot" "Yeah but...Teacher Lissa gives us a lot of homework like this one, they're just games..." "sad">>
            <<linkreplace " Continue ▶ ">>
              <<say "dot" "I'm good at math not at this!" "frustrated">>
              <<linkreplace " Continue ▶ ">>
                You sit down by Dot's side, and Belle sits on the other side, both of you take a look. 
                <<linkreplace " Continue ▶ ">>
                  <<say "belle" "OH! YOU JUST HAVE TO..." "images/characters/belle_screaming.png">>
                  <<linkreplace " Continue ▶ ">>
                    <<say "belle" "Nevermind I can't read." "images/characters/belle_neutral.png">>
                    <<linkreplace " Continue ▶ ">>
                      <<say "dot" "HA!" "laughing">>
                      Belle laughs along with Dot, you chuckle, it's nice to see them laugh together, and that sad face of Dot's is gone.
                      <<linkreplace " Continue ▶ ">>
                        <<say "belle" "Just like uncle David" "images/characters/belle_whisper.png">>
                        <<linkreplace " Continue ▶ ">>
                        Belle and Dot stare at each other for a moment, then they both laugh their asses off. 
                        You take the opportunity to take a look at the homework, it looks like some word scrambles.
                        [[Homework]]

 <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>
 <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>
 <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Dress up {"position":"975,925","size":"100,100"}
<<if !$dressed>>
Do you want to dress up?

[[Get dressed]]
<<else>>
  All done, looking good!

  [[Wardrove |Wardrove]]
  [[Stairs, Living room |Living Room]]
  <</if>>


:: Found Diana {"position":"1475,1850","size":"100,100"}
<<if !$backpack.has("waterbucket")>>
  <<say "belle" "DIANA!" "images/characters/belle_screaming.png">>
   <<set $foundDiana = true>>
    Belle runs and takes Diana out of the water bucket, her fur is wet and dripping. Amber takes her in her arms and squeezes some of the water off her fur.
<div id="pickupWater">
    That 
    <<link "🪣 water bucket">>
        <<replace "#pickupWater">>
            <<pickup $backpack "waterbucket" 1>>
            <p>You picked up the water bucket.</p>
            [[Return->Tena's stable]]
        <</replace>>
    <</link>>
    could be useful...
</div>
<</if>>



:: Found Penelope {"position":"1225,1850","size":"100,100"}
Penelope rests on the record player, turning in circles, her plump, furry belly up, purring. She doesn't have a care in the world.
<<linkreplace " Continue ▶ ">>
<<say "david" "Penelope, you traitor." "images/characters/david_cry.png">>
David goes to pick her up, she hisses and kicks, but he manages to not get all scratche up. 
<<linkreplace " Continue ▶ ">>
<<say "malik" "I'm sorry. Really don't know how she got in. Good thing you came looking for her." "worried">>
<<linkreplace " Continue ▶ ">>
Penelope screams and kicks in David's arms.
<<linkreplace " Continue ▶ ">>
<<say "david" "n-no problem!" "images/characters/david_wideeyed.png">>
[[With all cats found,go back home]]
 <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>>


:: FoundSabrina {"position":"1350,1850","size":"100,100"}
<<say "belle" "That tickles!" "images/characters/belle_laughing.png">>
<<linkreplace " Continue ▶ ">>
Sabrina gets up and smells the air, then, with no warning, she jumps down right on top of both, Belle and Loretta, who she is still holding.
Loretta hisses, but takes the hit. You have no more option but to put Belle back down with the two cats now in her arms. 
<<linkreplace " Continue ▶ ">>
<<say "belle" "YES, YES!!!! YES!!!! MORE CATS!!!" "images/characters/belle_screaming.png">>
The feeling of holding two big fat cats in her arms is way too strong, they're so big, and her arms are so short, that their bodies just hang down.
<<linkreplace " Continue ▶ ">>
<<say "amber" "one less, thanks god...let's go look for Diana">>
[["Any idea where she could be?"]]
<<set $foundSabrina = true>>

<</linkreplace>>
<</linkreplace>>
<</linkreplace>>



:: Frau_Otta {"position":"3275,2300","size":"100,100"}
<<say "frau" "Ah..Otta..Otta...I don't remember where I last saw her." "thinking">>
<<linkreplace " Continue ▶ ">>
  <<say "frau" "say, you guys up for a game?" "smile">>
  <<linkreplace " Continue ▶ ">>
    <<say "mordred" "A game?" "confused">>
    <<linkreplace " Continue ▶ ">>
      <<say "belle" "YESS I LOVE GAMES" "images/characters/belle_screaming.png">>
      <<linkreplace " Continue ▶ ">>
        <<say "dot" "As long as it's not world scrambles." "laughing">>
        [[Wait, no, we're looking for Otta->Frau_Otta2]]
        [[Okay, let's play->Frau_Quiz]]
        <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Frau_Otta2 {"position":"3200,2425","size":"100,100"}
<<say "mordred" "Wait, no, we`re looking for Otta." "neutral">>
 <<linkreplace " Continue ▶ ">>
  <<say "frau" "Well if you play I'll tell you where Otta is!" "smile">>
  <<linkreplace "You don't seem to have an option here...">>
  <<say "frau" "This is a quiz that will test your deepest knowledge about your family and friends!" "presenting">>
<<linkreplace " Continue ▶ ">>
  <<say "frau" "If you answer all questions correctly..." "images/characters/frau_suspense.png">>
  He gets closer to you and whispers
  <<linkreplace " Continue ▶ ">>
    <<say "frau" "I'll tell you where Otta is." "whisper">>
    <<linkreplace " Continue ▶ ">>
      <<say "frau" "And...you each will win a huge...shining price!!" "brightsmile">>
      <<linkreplace " Continue ▶ ">>
        <<say "belle" "YES!!!" "screaming">>
        <<linkreplace " Continue ▶ ">>
          <<say "frau" "Are you ready?, remember, if you don`t know an answer, you can go find out and come back later!" "finger">>
          <<linkreplace " Continue ▶ ">>
            <<say "dot" "like a tresure hunt?" "images/characters/dot_thinking.png">>
            <<linkreplace " Continue ▶ ">>
              <<say "frau" "You're absolutely right, young Dot. Sha`ll we start?" "brightsmile">>

              [[The Quiz starts->Frau_Quiz1]]

              <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Frau_Quiz {"position":"3325,2425","size":"100,100"}
<<say "frau" "This is a quiz that will test your deepest knowledge about your family and friends!" "presenting">>
<<linkreplace " Continue ▶ ">>
  <<say "frau" "If you answer all questions correctly..." "suspense">>
  He gets closer to you and whispers
  <<linkreplace " Continue ▶ ">>
    <<say "frau" "I might tell you where Otta is." "whisper">>
    <<linkreplace " Continue ▶ ">>
      <<say "frau" "And...anyone under 10 years old gets a price!" "brightsmile">>
      <<linkreplace " Continue ▶ ">>
        <<say "belle" "YES!" "images/characters/belle_screaming.png">>
        <<linkreplace " Continue ▶ ">>
          <<say "frau" "Are you all ready?" "finger">>
          <<linkreplace " Continue ▶ ">>
            <<say "dot" "like a tresure hunt?" "images/characters/dot_thinking.png">>
            <<linkreplace " Continue ▶ ">>
              <<say "frau" "You're absolutely right, young Dot. Sha`ll we start?" "brightsmile">>

              [[The Quiz starts->Frau_Quiz1]]

              <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Frau_Quiz1 {"position":"3250,2600","size":"100,100"}

This looks like it's going to take require memory...maybe you should go back and make sure you've talked to everyone in the dome or write down the answers when you get them right, in case you need to come back later.
Dot takes out his notebook and lends it to you.

<<linkreplace " Continue ▶ ">>
<<say "Frau" "First question!" "images/characters/frau_smile.png">>
<<linkreplace " Continue ▶ ">>
<<say "Frau" "David has a soft, mustard colored cat, what's her name?" "images/characters/frau_thinking.png">>
<<textbox "$question1" "">>\
<<link "Confirm">>\
<<replace "#answerArea">>\
<<if $question1.toLowerCase() == "sabrina">>
  <<say "frau" "Correct! one out of five" "images/characters/frau_brightsmile.png">>
  [[Next question->Frau_Quiz2]]
<<else>>
  <<say "frau" "Oops, that's not it but you're close!" "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "I heard that she likes to climb trees...but has a hard time coming back down..." "images/characters/frau_thinking.png">>
    <</linkreplace>>
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div>

[[Go back to the Dome->Dome1]]

<</linkreplace>><</linkreplace>>

:: Frau_Quiz2 {"position":"3250,2700","size":"100,100"}

<<say "Frau" "second question!" "images/characters/frau_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "Frau" "What flower does Heather's tea mix have?" "images/characters/frau_thinking.png">>
<<textbox "$question2" "">>\
<<link "Confirm">>\
<<replace "#answerArea">>\
<<if $question2.toLowerCase() == "butterfly pea" or $question2.toLowerCase() == "butterfly pea flower">>
  <<say "frau" "Correct!" "images/characters/frau_brightsmile.png">>
  [[Next question->Frau_Quiz3]]
<<else>>
  <<say "frau" "Heh...no, that's not it." "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "belle" "butterfly something!" "images/characters/belle_seriously.png">>
    <</linkreplace>>
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div>
    <</linkreplace>>

[[Go back to the Dome->Dome1]]

:: Frau_Quiz3 {"position":"3250,2800","size":"100,100"}
<<say "Frau" "third question..." "images/characters/frau_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "Frau" "Novi and The Shades performed a breathtaking concert today, what's the name of Novi's song?" "images/characters/frau_thinking.png">>
<<textbox "$question3" "">>\
<<link "Confirm">>\
<<replace "#answerArea">>\
<<if $question3.toLowerCase() == "spiderwebs">>
  <<say "frau" "Correct!" "images/characters/frau_brightsmile.png">>
  [[Next question->Frau_Quiz4]] 
<<else>>
  <<say "frau" "No, that's not it." "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "It has something to do with bugs. I think" "images/characters/frau_embarassed.png">>
    <</linkreplace>>
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div>
[[Go back to the Dome->Dome1]]
<</linkreplace>>

:: Frau_Quiz4 {"position":"3250,2900","size":"100,100"}
<<say "Frau" "You're doing so well, only two questions left!" "images/characters/frau_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "Frau" "What is Nina studying?" "images/characters/frau_thinking.png">>
<<textbox "$question4" "">>\
<<link "Confirm">>\
<<replace "#answerArea">>\
<<if $question4.toLowerCase() == "genetics" or $question4.toLowerCase() == "genetic engineering">>
  <<say "frau" "Correct!" "images/characters/frau_brightsmile.png">>
  [[Next question->Frau_Quiz5]]
<<else>>
  <<say "frau" "No, that's not it." "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "She, me and Neo, we're planning on making it possible for everyone to have kids! Isn't that amazing?" "images/characters/frau_happy.png">>
    <<linkreplace " Continue ▶ ">>
      <<say "belle" "The what now??" "images/characters/belle_happy.png">>
      <<linkreplace " Continue ▶ ">>
        <<say "dot" "You mean like our aunties?... That's cool if you make it work!" "images/characters/dot_smile.png">>
        <<linkreplace " Continue ▶ ">>
          <<say "frau" "Exactly. Nina is a brilliant woman, and we have the tech. We should figure it out, thanks kids." "images/characters/frau_smile.png">>
      <</linkreplace>>
    <</linkreplace>> <</linkreplace>> <</linkreplace>>
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div> 
[[Go back to the Dome->Dome1]]
<</linkreplace>>

:: Frau_Quiz5 {"position":"3250,3000","size":"100,100"}
<<say "Frau" "Last question!" "images/characters/frau_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "Frau" "What is the name of the first animal that was cured of mutation in the Dome?" "images/characters/frau_thinking.png">>
<<textbox "$question5" "">>\
<<link "Confirm">>\
<<replace "#answerArea">>\
<<if $question5.toLowerCase() == "joy">>
  <<say "frau" "Correct!" "images/characters/frau_brightsmile.png">>
  <<linkreplace " Continue ▶ ">>
    <<say "frau" "You did it! You answered all questions correctly!" "images/characters/frau_happy.png">>
    <<linkreplace " Continue ▶ ">>
      Frau turns around and looks in the inside pockets of his jacket, looking for the price, but then you hear a notification. You're familiar with that sound, it's from the dome's clocks they use to communicate.
      <<linkreplace " Continue ▶ ">>
        He turns back to you.
        <<say "frau" "Oh...oh- eh...actually there's more questions!" "images/characters/frau_nervioussmile.png">>
        <<linkreplace " Continue ▶ ">>
          Taking a paper out of his pocket, he seems increasingly nervious until he crumples it and saves it back. 
          <<say "frau" "Aah...next question!...ehh.." "images/characters/frau_nervioussmile.png">>
          [["Wait,wait, what's going on?"->Frau_QuizInterlude]]
          [["Ok let's just do this."->Frau_Quiz6]]
          <</linkreplace>>
          <</linkreplace>>
          <</linkreplace>>  
           <</linkreplace>>  
           <<else>>
  <<say "frau" "Aaaah, no, no, try again." "images/characters/nervioussmile.png">>
      <<linkreplace "Clue">>
    <<say "frau" "She's one of our main sources of food" "images/characters/frau_happy.png">>
      <</linkreplace>>
<</if>>\
<</replace>>
<</link>>

<div id="answerArea"></div>
[[Go back to the Dome->Dome1]]
    <</linkreplace>>

:: Frau_QuizInterlude {"position":"3250,3100","size":"100,100"}
<<say "mordred" "Wait, wait, what's going on?" "images/characters/mordred_suspicious.png">>
<<linkreplace " Continue ▶ ">>
<<say "frau" "Oh, nothing, nothing, just a little change of plans." "images/characters/frau_nervioussmile.png">>
<<linkreplace " Continue ▶ ">>
  <<say "belle" "I wanna keep playing!" "images/characters/belle_screaming.png">>
  <<linkreplace " Continue ▶ ">>
    <<say "frau" "Yes, we should!" "images/characters/frau_nervioussmile.png">>
    <<linkreplace " Continue ▶ ">>
      You give Dot a questioning glance, he has no reactions about the situation. When he notices you looking at him, he shrugs and avoids your gaze.
      [[Next question->Frau_Quiz6]]
      <</linkreplace>>
      <</linkreplace>>
      <</linkreplace>>
      <</linkreplace>>

:: Frau_Quiz6 {"position":"3250,3200","size":"100,100"}
<<say "frau" "N-next question! These are a little harder..." "images/characters/frau_happy.png">
<<linkreplace " Continue ▶ ">>
  This time, Frau takes out a notebook, it's messy and pieces of paper escape from it's edges, Frau's name is engraved on the cover, but it's not his handwriting.
  <<linkreplace " Continue ▶ ">>
<<say "frau" "What four ingredients does a portal ritual require in Vessel of Nyx?" "images/characters/frau_thinking.png">>
<<textbox "$question6" "">>\
<<link "Confirm">>
<<replace "#answerArea">>

<<script>>
let answer = State.getVar("$question6").toLowerCase();
let required = ["ash", "charcoal", "wax", "sulfur"];
let isCorrect = required.every(ingredient => answer.includes(ingredient));
State.setVar("$portalCorrect", isCorrect);
<</script>>
<<if $portalCorrect>>
  <<say "frau" "Correct!...six out of..who knows " "images/characters/frau_nervioussmile.png">>
  [[Next question->Frau_Quiz7]]
<<else>>
  <<say "frau" "Eeeh... nope" "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "Three of them are fire related, the other one is known for smelling pretty bad." "images/characters/frau_thinking.png">>
  <</linkreplace>>
<</if>>
<</replace>>
<</link>>
<div id="answerArea"></div>
[[Go back to the Dome->Dome1]]

<</linkreplace>>

:: Frau_Quiz7 {"position":"3250,3300","size":"100,100"}
<<say "frau" "Let's get to it. Who won the prank war of the CENTURY?" "images/characters/frau_happy.png">>
<<textbox "$question7" "">>\
<<link "Confirm">>\
<<replace "#answerArea">>\
<<if $question7.toLowerCase() == "genetics" or $question7.toLowerCase() == "tril">>
  <<say "frau" "Correct!" "images/characters/frau_brightsmile.png">>
  [[Next question->Frau_Quiz8]]
<<else>>
  <<say "frau" "No, that's not it." "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "The ones involved really enjoy non eculidean shapes and optical ilussions" "images/characters/frau_happy.png">>
    <</linkreplace>> 
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div>
[[Go back to the Dome->Dome1]]

:: Frau_Quiz8 {"position":"3250,3400","size":"100,100"}
<<say "frau" "How many mixed couples, Aquari and Vessel of Nyx are together, currently?" "images/characters/frau_thinking.png">>
<<textbox "$question8" "">>\
<<link "Confirm">>
<<replace "#answerArea">>
<<if $question8.toLowerCase() == "nine" or $question8.toLowerCase() == "9">>
  <<say "frau" "Correct!" "images/characters/frau_brightsmile.png">>
  [[Next question->Frau_Quiz9]]
<<else>>
  <<say "frau" "No, that's not it." "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "Anyone in space, or secretive about their relationship still count, don't forget them." "images/characters/frau_happy.png">>
    <</linkreplace>>
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div>
[[Go back to the Dome->Dome1]]

:: Frau_Quiz9 {"position":"3250,3500","size":"100,100"}
Frau checks his clock real quick, then looks back at the notebook neriously. Dot and Belle share a look of nerviousness and you can't help but notice.
<<linkreplace " Continue ▶ ">>
<<say "frau" "When was the Aquari and Vessel of Nyx portal first opened?" "images/characters/frau_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "frau" "Your options are... A.12/2021, C.1/2022, B.10/2022, D.11/2022" "images/characters/frau_happy.png">>
<<linkreplace " Continue ▶ ">>
<<textbox "$question9" "">>\
<<link "Confirm">>
<<replace "#answerArea">>
<<if $question9.toLowerCase() == "10/2022">>
  <<say "frau" "Correct!" "images/characters/frau_brightsmile.png">>
 [[Last question->Frau_Quiz10]]
<<else>>
  <<say "frau" "No, that's not it." "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "I..gave a history class about it yesterday or something?" "images/characters/frau_thinking.png">>
    <</linkreplace>>
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div> 
[[Go back to the Dome->Dome1]]
<</linkreplace>><</linkreplace>><</linkreplace>>

:: Frau_Quiz10 {"position":"3250,3600","size":"100,100"}
<<say "frau" "This is the last question!..and please be!" "images/characters/frau_impatient.png">>
<<linkreplace " Continue ▶ ">>
<<say "frau" "We're celebrating something very important today, what is it?" "images/characters/frau_happy.png">>
<<linkreplace " Continue ▶ ">>
<<textbox "$question10" "">>\
<<link "Confirm">>
<<replace "#answerArea">>
<<if $question10.toLowerCase() == "mordred's birthday" or $question10.toLowerCase() == "mordred birthday" or $question10.toLowerCase() == "mordred's bday" or $question10.toLowerCase() == "mordred bday">>
  <<say "frau" "That's--IT'S YOUR BIRTHDAY?" "images/characters/frau_horror.png">>
  <<linkreplace " Continue ▶ ">>
    <<say "frau" "Oh no I can't believe I forgot...come come, let's go to the hangar and eat something" "images/characters/frau_sad.png">>
      [[You passed!->Surprise]]
      <</linkreplace>>
  <<elseif $question10.toLowerCase() == "launch day" or $question10.toLowerCase() == "launchday">>
    <<say "frau" "That's correctly incorrect! You passed!" "images/characters/frau_brightsmile.png">>
    [[You passed!->Surprise]]
<<else>>
  <<say "frau" "No, that's not it." "images/characters/nervioussmile.png">>
  <<linkreplace "Clue">>
    <<say "frau" "It's a very important for the story of the dome and anyone who wants to escape from this nightmarish hellscape full of waterdogs." "images/characters/frau_thinking.png">>
    <</linkreplace>>
<</if>>\
<</replace>>
<</link>>
<div id="answerArea"></div>
<</linkreplace>>
<</linkreplace>>


[[Go back to the Dome->Dome1]]

:: Surprise {"position":"3250,3700","size":"100,100"}
<<say "frau" "You passed! Congratulations!" "images/characters/frau_brightsmile.png">>
<<linkreplace " Continue ▶ ">>
  Frau takes you to the hangar's big door.
  <<say "frau" "Here's your price!" "images/characters/frau_happy.png">>
  <<linkreplace " Continue ▶ ">>
    <<say "belle" "our price is the launch day celebration?" "images/characters/belle_seriously.png">>
    <<linkreplace " Continue ▶ ">>
      <<say "frau" "why don't you find out?" "images/characters/frau_smile.png">>
      [[Go in->SURPRISE PARTY]]
      <</linkreplace>>
    <</linkreplace>>
  <</linkreplace>>

:: SURPRISE PARTY {"position":"3250,3800","size":"100,100"}
<<script>>UIBar.stow()<</script>>

 After opening the door, you walk in reluctantly...it's so dark...


 <<timed 5s t8n>>
  <h1> SURPRISE!! </h1>
 <script>
confetti({
  particleCount: 250,
  spread: 300,
  origin: { y: 0.6 },
  gravity: 0.3,
  colors: ["#d851a4ff", "#87a5e4ff", "#eab756ff", "#cbe1c5ff"],
  ticks: 150,
});
</script>
<<timed 5.5s t8n>>
   <script>
confetti({
  particleCount: 250,
  spread: 300,
  origin: { y: 0.6 },
  gravity: 0.3,
  colors: ["#d851a4ff", "#87a5e4ff", "#eab756ff", "#cbe1c5ff"],
  ticks: 150,
});
</script>
<</timed>>
 <img src="images/characters/HappyBirthdayLOWRES.png" style="width:100%; height:auto;">

   <<timed 6s t8n>> [[Continue->SURPRISE PARTY0]]
<</timed>>

 <</timed>>

::SURPRISE PARTY0
<<script>>UIBar.stow()<</script>>

 <<say "belle" "DAD! HAPPY BIRTHDAY!" "images/characters/belle_screaming.png">>
 <<linkreplace "Continue">>
 <<say "dot" "Happy birthday, dad! I love you!" "images/characters/dot_smile.png">>
 Both of them hug you tightly. 
 <<linkreplace " Continue ▶ ">>
  Someone hugs you from the back then.
<<linkreplace " Continue ▶ ">>
  <<say "otta" "Happy birthday, my heart" "images/characters/otta_blush.png">>
  <<linkreplace " Continue ▶ ">>
    Your family hugs you and it doesn't take long when others start to join in, from one second to the other you're being crushed by a pile of people cheering and shouting your name.
    After Otta follows David, then Amber then Nico then Heather then Bastet then Samira then everyone else who isn't really a part of your direct family but just friends of your friends!!...
    EVEN TENA IS HERE!!
    <<linkreplace " Continue ▶ ">>
[[YOU'RE CRUSHING ME->SURPRISE PARTY2]]
[[Thank you everyone!->SURPRISE PARTY2]]
[[say nothing and take it in->SURPRISE PARTY2]]
 <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>

:: SURPRISE PARTY2 {"position":"3250,3900","size":"100,100"}
<<script>>UIBar.stow()<</script>>
Eventually everyone lets go, and you can finally breathe again. Otta gives you a kiss on the cheek.
<<linkreplace " Continue ▶ ">>
<<say "otta" "Enjoy yourself! we can talk later." "images/characters/otta_blush.png">>
From now on, everyone just keeps approaching you to congratulate you, give you a gift, or say any other random thing.
<<linkreplace " Continue ▶ ">>
  <<say "david" "Happy birthday! was I good at pretending to be asleep?" "images/characters/david_smile.png">>
  <<linkreplace " Continue ▶ ">>
    <<say "belle" "DAD, it was so fun keeping you busy all day" "images/characters/belle_laughing.png">>
    <<linkreplace " Continue ▶ ">>
      <<say "dot" "yeah, we should do it everyday." "images/characters/dot_smile.png">>
      The idea terrifies you.
      <<linkreplace " Continue ▶ ">>
        <<say "amber" "Sorry to make you run around because of the cats, we set it all up to keep you busy." "images/characters/amber_smile.png">>
        <<linkreplace " Continue ▶ ">>
          <<say "bastet" "Oh yeah. We were all in on it, sorry." "images/characters/bastet_happy.png">>
          <<linkreplace " Continue ▶ ">>
            <<say "frau" "Happy birthday, Mord! yeah, I wish they've told me to make more questions beforehand though." "images/characters/frau_smile.png">>
            <<linkreplace " Continue ▶ ">>
              <<say "esir" "You did great, love." "images/characters/esir_wink.png">>
              <<linkreplace " Continue ▶ ">>
                Then there's everyone else who is too busy to come to you, but they're all full of joy.
                 <<linkreplace " Continue ▶ ">>
                <<say "novi" "Let's play something!" "images/characters/novi_smile.png">>
                <<linkreplace " Continue ▶ ">>
                  <<say "johnny" "bring it onnn! this one is for bro Mordred! one, two, three..." "smile">>
                  <<linkreplace " Continue ▶ ">>
                    <<audio "bass" play>>
                    Otta is standing by your side, she tilts her head at the Shades and Novi playing their instruments.
                    <<linkreplace "Continue">>
                    <<say "otta" "That wasn't really planned. They just kinda showed up." "confusedsmile">>
                    <<linkreplace " Continue ▶ ">>
                      <<say "quiroga" "For once in my life, I feel like eating something." "images/characters/quiroga_neutral.png">>
                      Quiroga and Grandad stand by the sweets table, Grandad eats anything Quiroga tries but then disaproves of.
                      <<linkreplace " Continue ▶ ">>
                        <<say "bastet" "Don't put your dirty hands on all the food!" "images/characters/bastet_nervious.png">>
                        <<linkreplace " Continue ▶ ">>
                          <<say "nico" "Happy birthday, kiddo." "images/characters/nico_smile.png">>
                          <<linkreplace " Continue ▶ ">>
                            <<say "heather" "Happy birthday, Mord! I made the drinks!" "images/characters/heather_smile.png">>
                            <<linkreplace "Continue">>
                              <<say "strad" "Happy birthday!" "smile">>
                              <<linkreplace "Continue">>
                                <<say "mordred" "who are you?" "surprised">>
                                <<linkreplace "Continue">>
                                  <<say "strad" "No idea!, happy birthday Mordred!" "smile">>
                                  <<linkreplace "Continue">>
                                    <<say "grandad" "happy birthday.">>
                                    <<linkreplace "Continue">>
                                      You don't know what to say. When people finally stop approaching you, you take a breath.
                            [[Continue->End]]
  <</linkreplace>>    <</linkreplace>>
  <</linkreplace>>    <</linkreplace>>
  <</linkreplace>>    <</linkreplace>>
  <</linkreplace>>    <</linkreplace>>
  <</linkreplace>>    <</linkreplace>>
  <</linkreplace>>    <</linkreplace>>
  <</linkreplace>>    <</linkreplace>>
  <</linkreplace>> <</linkreplace>>
<</linkreplace>> <</linkreplace>>
<</linkreplace>> <</linkreplace>>
<</linkreplace>> <</linkreplace>>

:: End 
<<script>>UIBar.stow()<</script>>
The congratulations seem endless; even people you've had a few misunderstandings with in the past are here and having a great time, celebrating you. After greeting everyone, you finally sit down to eat, exhausted. Otta sits with you. She has a bright smile, her hair in star shapes, her eyeshadow glittery, and her lips golden.
There was no such thing as a launch day. It was all for you.
                              <<linkreplace " Continue ▶ ">>
                              <<say "otta" "This can be a little overwhelming" "images/characters/otta_laughing.png">>
                              <<linkreplace " Continue ▶ ">>
                                <<say "otta" "But me...and everyone else, wanted to make something special." "images/characters/otta_blushing.png">>
                                <<linkreplace " Continue ▶ ">>
                                 <<say "otta" "There's no way to express how...you make my whole life a delight." "images/characters/otta_blushing.png">>
                                  <<linkreplace " Continue ▶ ">>
Otta starts tearing up, she wipes her eyes and looks away.
<<linkreplace " Continue ▶ ">>
<<say "otta" "I might have also rented that one place we stayed in Orts once..remember? with the pool?" "images/characters/otta_blushing.png">>
<<linkreplace " Continue ▶ ">>
  <<say "otta" "Everything is sorted out. The kids are going to stay with David and Amber, and we're going to have a little vacation." "images/characters/otta_blushing.png">>
  <<linkreplace " Continue ▶ ">>
    <<say "otta" "Only us." "images/characters/otta_blushing.png">>
    <<linkreplace " Continue ▶ ">>
      <<say "otta" "happy birthday, my love." "images/characters/otta_blushing.png">>
      <<timed 2s t8n>>
      Otta kisses Mordred on the lips, and he can feel her smile against his.<</timed>>
      <<timed 4s t8n>>
        [[Goodbye]]
        <</timed>>
          <</linkreplace>>
        <</linkreplace>>
      <</linkreplace>>
    <</linkreplace>>
  <</linkreplace>>
      <</linkreplace>>
  <</linkreplace>>    <</linkreplace>>

:: Frau_WhatYouDoing {"position":"3050,2425","size":"100,100"}
<<say "frau" "Not even I know, mordred!, crazy, isn't it?" "laughing">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "have you seen mom?" "really">>
[[Continue->Frau_Otta]] 
<</linkreplace>>

:: Gardens {"position":"2600,2825","size":"100,100"}
The gardens are beautiful, and most importantly, not as mutated as they are outside the dome. Still, somewhat mutated.

[[Dome(back to start)->Dome1]]
[[Meriem's mansion]]
[[Dome Plaza]]
[[Barn]]
[[Lake]]
[[Back Garden]]
[[Crops]]


:: Get dressed {"position":"1100,1025","size":"100,100"}
Mordred dresses without any hurry. No more flyaway hairs or striped pajamas.

[[Bedroom]]
<<set $dressed = true>>


:: Go to Nico's {"position":"1200,1250","size":"100,100"}
<<if !$foundLoretta>>
Nico and Belle are standing outside the house holding fishing rods, he's opening the door.
<<linkreplace " Continue ▶ ">>
<<say "belle" "<span class='vibrate'>Dad!!!</span>" "images/characters/belle_screaming.png">>
Belle runs up to you and gives you a big hug at leg level. As you stroke her hair, a strong smell of fish comes out, it's greasy and wet...
<<linkreplace " Continue ▶ ">>
<<say "belle" "Grandpa taught me how to fish! Look! Here!" "images/characters/belle_happy.png">>
Belle buries her little hand into a slimy, smelly bucket of anchovies and catfish, <<linkreplace " handing you a...">>
crab?. She wipes it on her clothes to clean it. It's long dead, dried out, only the skeleton remains.
<<pickup $backpack "crab" 1>>
[[Thank you ->Like the crab]]
[[Thank you? ->Like the crab]]
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>

<</if>>
<<if $foundLoretta>>
 Nico must be taking a shower and resting after that fishing session.
 <<linkreplace " Continue ▶ ">>
 <<say "belle" "Grandpa is the BEST" "images/characters/belle_smile.png">>
 <<return>>
 <</linkreplace>>
 <</if>>


:: Good enough {"position":"1900,1450","size":"100,100"}
You lift the rock, it's heavy, but you manage to lift it above your head. 

<<linkreplace " Continue ▶ ">>
<<say "grandad" "Good enough." "neutral">>
<<linkreplace " Continue ▶ ">>
  Grandad walks to the cabin's back door, and he simply opens the door to let you in.
  <<linkreplace " Continue ▶ ">>
    It was open this whole time?...

    [[Samira's kitchen]]
    <</linkreplace>>
<</linkreplace>><</linkreplace>>


:: Goodbye {"position":"3300,2925","size":"100,100"}
Happy birthday Ding!!!!!!!
<<linkreplace "yaay">>
Please tell me what you think!
Maybe it's a bit of an intense gift, but I've always wanted to make something like this, and our stories combined inspired me to give it a try! Also you're a great friend and wanted to really show how much I appreciate you, your creations and the time we spend together ❤️
<</linkreplace>>

:: GotAirHorn {"position":"850,1725","size":"100,100"}
You pick up the airhorn!
<<set $davidAwake = true>>
<<linkreplace " Continue ▶ ">>
 <<say "david" "What's going on?!" "images/characters/david_wideeyed.png">>
 <<linkreplace " Continue ▶ ">>
<<say "amber" "The cats went missing and we couldn't wake you up!">>
<<linkreplace " Continue ▶ ">>
<<say "mordred" "We're still missing Penelope. I have an idea where she might be.">>
[[To Metis]]

     <</linkreplace>> <</linkreplace>> <</linkreplace>>


:: Grandad and Quiroga2 {"position":"1900,1700","size":"100,100"}
You walk back outside, and Grandad and Quiroga are still there, waiting for you.
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "There's no flour or sugar." "neutral">>
  <<linkreplace " Continue ▶ ">>
    <<say "quiroga" "We have at home,but Lissa is keeping me out" "neutral">>
    <<linkreplace " Continue ▶ ">>
      <<say "mordred" "Why?- forget it, maybe she'll let me in." "suspicious">>
<<linkreplace " Continue ▶ ">>
  <<say "quiroga" "perhaps...here" "neutral">>
<div id="keyresult"></div>
<<if !$backpack.has("quirogaskeys")>>
	<<linkreplace "Quiroga hands you the cabin's keys.">>
		<<replace "#keyresult">>
			<<pickup $backpack "quirogaskeys" 1>>
			<p>You took the keys.</p>
			[[Go to Lissa's cabin->Lissa's cabin]]
		<</replace>>
	<</linkreplace>>
<</if>>
    <</linkreplace>>    <</linkreplace>>    <</linkreplace>>    <</linkreplace>>


:: Have you seen Herb? {"position":"3000,2025","size":"100,100"}
<<say "grandad" "No." "neutral">>
[[Have you seen Lissa?]]
[[Have you seen Samira?]]
        <<if hasVisited("Have you seen Herb?" && "Have you seen Samira?" && "Have you seen Lissa?")>>
[[Can you just help me?]]
<</if>>


:: Have you seen Lissa? {"position":"2875,1725","size":"100,100"}
<<say "quiroga" "She's sick, resting home.">>
  <<linkreplace " Continue ▶ ">>
<<say "quiroga" "..." "sideways">>
 <<linkreplace " Continue ▶ ">>
  <<say "mordred" "Sick how?" "suspicious">>
  <<linkreplace " Continue ▶ ">>
    <<say "quiroga" "I don't really know. She doesn't want me at home." "neutral">>
    <<linkreplace "What?...">>
      Moving on...
[[Have you seen Herb?]]
[[Have you seen Samira?]]
 <<if hasVisited("Have you seen Herb?" && "Have you seen Samira?" && "Have you seen Lissa?")>>
[[Can you just help me?]]
<</if>>

<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>

:: Have you seen Samira? {"position":"3000,1725","size":"100,100"}
  <<say "grandad" "she's at the Dome.">>
  <<linkreplace " Continue ▶ ">>
      <<say "mordred" "What is she doing there?" "suspicious">>
          Why would she be preparing things for launch day?...
      <<linkreplace " Continue ▶ ">>
        <<say "grandad" "preparing things for-">>
        Quiroga launches Grandad to the sky this time.
  <<linkreplace "'Why did you just do that?'">>
   <<say "mordred" "Why did you just do that?" "surprised">>
    <<linkreplace " Continue ▶ ">>
      That moment, Grandad falls back down, this time Quiroga does catch him with telekinesis, but he still falls to the ground face buried in the snow.
        [[Have you seen Herb?]]
        [[Have you seen Lissa?]]
        <<if hasVisited("Have you seen Herb?" && "Have you seen Samira?" && "Have you seen Lissa?")>>
[[Can you just help me?]]
<</if>>
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Heather's outside {"position":"1050,1350","size":"100,100"}
It's a beautiful morning in Metis, the air feels humid and smells like rain, droplets fall from the trees, the grass is green and shiny.
<<linkreplace " Continue ▶ ">>
The front yard is spacious, surrounded by a fence and the woods. The crops are beginning to bear fruit and vegetables. Heather is watering them. Behind her, a lot of chickens eat grass, bugs, and cluck back and forth. 
<<linkreplace " Continue ▶ ">>
[["Hello, Heather!"]]
[[Tena's stable]]
[[Home->Living Room]] 

[[To Metis]]
<</linkreplace>><</linkreplace>>

:: Homework {"position":"1850,2725","size":"100,100"}
<p class="lissafont">Animal word scrambles</p>
<!-- 1 -->
<<nobr>>
<p class="lissafont">1. ROEHS</p>
<div id="step1">
	<<textbox "$answer1" "">>
	<<link "Confirm">>
		<<replace "#step1">>
			<<if $answer1.toLowerCase() == "horse">>
				<p class="dotfont">1. Horse</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer1" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 2 -->
<p class="lissafont">2. DBRI</p>
<div id="step2">
	<<textbox "$answer2" "">>
	<<link "Confirm">>
		<<replace "#step2">>
			<<if $answer2.toLowerCase() == "bird">>
				<p class="dotfont">2. Bird</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer2" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 3 -->
<p class="lissafont">3. GLOIARLTA</p>
<div id="step3">
	<<textbox "$answer3" "">>
	<<link "Confirm">>
		<<replace "#step3">>
			<<if $answer3.toLowerCase() == "alligator">>
				<p class="dotfont">3. Alligator</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer3" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 4 -->
<p class="lissafont">4. TNPLEHEA</p>
<div id="step4">
	<<textbox "$answer4" "">>
	<<link "Confirm">>
		<<replace "#step4">>
			<<if $answer4.toLowerCase() == "elephant">>
				<p class="dotfont">4. Elephant</p>
			<<else>>
				<p> Try again.</p>
				<<textbox "$answer4" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 5 -->
<p class="lissafont">5. ABITRB</p>
<div id="step5">
	<<textbox "$answer5" "">>
	<<link "Confirm">>
		<<replace "#step5">>
			<<if $answer5.toLowerCase() == "rabbit">>
				<p class="dotfont">5. Rabbit</p>
				[[Continue->Homework2]]
			<<else>>
				<p> Try again.</p>
				<<textbox "$answer5" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>
<</nobr>>

:: Homework2 {"position":"1975,2600","size":"100,100"}
<<say "belle" "Those look eassyyyy" "images/characters/belle_bored.png">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "yes, THOSE looked easy..." "images/characters/dot_serious.png">>
Dot passes the page. 
<<linkreplace " Continue ▶ ">>

<!-- 1 -->
<<nobr>>
  <p class="lissafont">Harder ones for you, Dot and your big brains!</p>

<p class="lissafont">1. HET UCIQK WORNB FOX </p>
<div id="step1">
	<<textbox "$answer1" "">>
	<<link "Confirm">>
		<<replace "#step1">>
			<<if $answer1.toLowerCase() == "the quick brown fox">>
				<p class="dotfont">1. The quick brown fox</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer1" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 2 -->
<p class="lissafont">2. MJSUP EVOR EHT ZAYL ODG</p>
<div id="step2">
	<<textbox "$answer2" "">>
	<<link "Confirm">>
		<<replace "#step2">>
			<<if $answer2.toLowerCase() == "jumps over the lazy dog">>
				<p class="dotfont">2. Jumps over the lazy dog</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer2" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>
<!-- 3 -->
<p class="lissafont">3. HELA LEAH FGRO BTUT</p>
<div id="step3">
	<<textbox "$answer3" "">>
	<<link "Confirm">>
		<<replace "#step3">>
			<<if $answer3.toLowerCase() == "heal heal frog butt">>
				<p class="dotfont">3. heal, heal, frog butt </p><p class="emojifont">🐸</p>
                [[Continue->Homework3]]
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer3" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>
<</nobr>>
<</linkreplace>><</linkreplace>>

:: Homework3 {"position":"2100,2600","size":"100,100"}
<<say "belle" "Teacher Lissa wrote frog BUTT?!" "images/characters/belle_laughing.png">>
<<linkreplace " Continue ▶ ">>
  <<say "dot" "forg butt, frog butt" "images/characters/dot_laughing.png">>
<<linkreplace " Continue ▶ ">>
  <<say "belle" "HAHA!!" "images/characters/belle_laughing.png">>
  They're back to laughing for a full minute.
  <<linkreplace " Continue ▶ ">>
<<say "dot" "Thanks dad, I think I can finish the math by myself." "proud">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "Good, I'm glad." "smile">>
  <<linkreplace " Continue ▶ ">>
    <<say "mordred" "Dot, have you seen your mother? I thought you were with her." "suspicious">>
    <<linkreplace " Continue ▶ ">>
      <<say "dot" "Ah, we were doing chores before but then she sat me here to do homework." "neutral">>
      <<linkreplace " Continue ▶ ">>
        <<say "dot" "Oh yeah and she asked Neo to look over me." "images/characters/dot_thinking.png">>
        <<linkreplace " Continue ▶ ">>
          <<say "dot" "But then he said nothing would happen to me inside the dome, and said that Looser and Winner would protect me." "images/characters/dot_thinking.png">>
          <<linkreplace " Continue ▶ ">>
Only now you notice the goose and goat watching you closely. Winner honks when he notices he's being stared at.
              <<linkreplace " Continue ▶ ">>
                <<say "mordred" "..." "eyebrow">>
                <<linkreplace " Continue ▶ ">>
                <<say "dot" "....." "images/characters/dot_thinking.png">>
                <<linkreplace " Continue ▶ ">>
                  <<say "belle" "SO CUTE!!!!" "screaming">>
                  Dot decides to do the math later, he rather join you in your adventure right now.
                  <<pickup $backpack "dot" 1>>
                  [[Continue->Dome1]]
        <</linkreplace>><</linkreplace>><</linkreplace>>   
             <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>     
                <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Interrumpt them {"position":"2550,2125","size":"100,100"}
You finally walk around the corner, they both turn to see you, blank faced.
  <<linkreplace " Continue ▶ ">>
    In that moment, the waterdog falls back down, Quiroga attempts to use telekinesis to stop it from expxloding in the ground, but he's used way too much mental energy already and can't stop it's speed.
    <<linkreplace " Continue ▶ ">>
      <<say "mordred" "I won't ask." "neutral">>
      <<linkreplace " Continue ▶ ">>
        <<say "grandad" "Good." "neutral">>

        [[Have you seen Herb?]]
        [[Have you seen Lissa?]]
        [[Have you seen Samira?]]

                <<if hasVisited("Have you seen Herb?" && "Have you seen Samira?" && "Have you seen Lissa?")>>
[[Can you just help me?]]
<</if>>

<</linkreplace>><</linkreplace>><</linkreplace>>


:: Intro {"position":"475,900","size":"100,100"}

[[TestRoom]]

<hr>

<h1> Hello Ding!!! </h1>
<<linkreplace " Continue ▶ ">>
This is a little game I made for your birthday, I hope you like it!
It's a little bit messy, but I tried to make it fun and include most of our characters.
But this is about Mordred!! so a lot of characters don't show up at all, I wanted them to but was running out of time.
<<linkreplace " Continue ▶ ">>
Any characters that belong to you I wrote as accurate as possible.
I wanted them to be involved the most, yet not write them too much, hopefully I hit the spot.
Tell me if you have better reactions for them XD I'm dying to know.

If you're using headphones, make sure the volume is below 50%
There /are/ bugs, by the way, some I couldn't fix, but they don't break the experience.
<<linkreplace "Continue ▶">>
  No Grandads and/or waterdogs were harmed in the making of this game.
  
 [[Start]]
 <</linkreplace>>
<</linkreplace>>
<</linkreplace>>

:: Investigate {"position":"1375,1450","size":"100,100"}
As you enter the alley, it feels like the two walls are closing in on you, getting narrower and narrower.
You walk up to a door that seems to lead nowhere. The frame is crooked and has an eye on it. From the gap below, a white light flickers.

<<if $backpack.has("airhorn")>>
  <<link 'Use the air horn!'>>
        <<goto "TOOOT!">>
    <</link>>
  <</if>>

[[Knock]]
[[Listen]]
[[Open the door]]
[[To Metis]]

:: Kids Bedroom {"position":"825,1225","size":"100,100"}
Mordred built this new room for the children in the last few months. It's divided so everyone has their own space. They love it, but they have toys and clothes scattered everywhere. Belle even has drawings on the walls.
[[Living Room]]

:: Knock [failtry] {"position":"1350,1575","size":"100,100"}
<<linkreplace "Knock knock!">>
 No answer.
<<return>>
<</linkreplace>>

:: Lake {"position":"2750,2825","size":"100,100"}
This lake is artificial and is primarily used for animal drinking, but sometimes, in the summer, it's used as a swimming pool. The water is so clear you can see the bottom. It's not that deep because it must have been dug half by hand and half by machine.
In the distance, you notice two figures...it's impossible not to recognize Novi and Johnny by their hairstyles. And the fact that they both hold their instruments...out here?
<<linkreplace "Say hello">>
<<say "johnny" "sup?" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "novi" "Hi!" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "mordred" "What are you two doing here?" "suspicious">>
<<linkreplace " Continue ▶ ">>
<<say "johnny" "checking out that single fish in the lake." "happy">>
You and the kids all look in the lake, in fact, there is one single koi fish. It's somewhat purple, but it seems to be in the process of being cured of mutation.
<<linkreplace " Continue ▶ ">>
<<say "belle" "Oh. But what are the instruments about?" "thinking">>
<<linkreplace " Continue ▶ ">>
<<say "Novi" "nothing in particular, we come from a concert, and decided to pass by for launch day" "happy">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "nice!,then we'll see you there." "smile">>
<<linkreplace " Continue ▶ ">>
  <<say "novi" "Yep. I heard it'll start in a bit" "smile">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "Have you seen Otta?" "thinking">>
  <<linkreplace " Continue ▶ ">>
    <<say "johnny" "I think I spotted her in the mansion somewhere" "smile">>
[[Gardens]]
<</linkreplace>><</linkreplace>><</linkreplace>>
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>
<</linkreplace>><</linkreplace>><</linkreplace>>


:: Lesle, Have you seen Otta? {"position":"2900,2950","size":"100,100"}
<<say "mordred" "Have you seen Otta?" "thinking">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "dad, he`s deaf" "seriously">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "he can read lips, Belle" "seriously">>
<<linkreplace " Continue ▶ ">>
<<say "lesle" "<p class='emojifont'>👋</p>" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "lesle" "<p class='asl'>sup im drawing</p>" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "hellooo!!! <p class='emojifont'>👋👋</p>" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "mordred" "Have you seen Otta, by any chance?" "thinking">>
Lesle shakes his head repeatedly, then clutches the board to his chest and shakes his legs in excitement.
<<linkreplace " Continue ▶ ">>
<<say "lesle" "<p class='asl'>I REAAAALLY shouldnt but...</p>" "smile">>
Lesle holds up the whiteboard for you three to see. It's a drawing of Mordred and Otta in their wedding altar.
<<linkreplace " Continue ▶ ">>
<<say "belle" "OH MY GOD WHY DIDN'T YOU DRAW IT IN PAPER?!" "screaming">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "that's amazing!, maybe we can take a picture and print it out." "smile">>
<<linkreplace " Continue ▶ ">>
<<say "lesle" "<p class='asl'>felt inspired, it just happened, didn't mean to make a drawing this big.</p>" "blushing">>
<<linkreplace " Continue ▶ ">>
<<say "lesle" "<p class='asl'>Zuri has been giving me a few art classes, couldn't get to this level without her</p>" "smile">>
[["Wait...did you draw that from memory or?"]]

<</linkreplace>> <</linkreplace>><</linkreplace>> <</linkreplace>><</linkreplace>>
<</linkreplace>> <</linkreplace>><</linkreplace>> <</linkreplace>><</linkreplace>> <</linkreplace>>


:: Library {"position":"2275,3250","size":"100,100"}
Upon arriving at the bookstore, you see a familiar face. Nina is sitting at an elegant wooden table, with a very comfortable cushion, with a stack of books, but she looks frustrated.

[[Nina]]
[[Return to Meriem's mansion->Meriem's mansion]]
[[Upstairs]]


:: Like the crab {"position":"1400,1025","size":"100,100"}
<<say "mordred" "I like it, did you have fun? we have to go back home now." "images/characters/mordred_happy.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "what go back home?! No!" "images/characters/belle_seriously.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "Dad, I was promised I would see David`s cats today!! all of them, he would bring them over!" "images/characters/belle_seriously.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "BUT THERE IS <span class='wave'> NO CATS HERE </span>" "images/characters/belle_screaming.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "only fish." "images/characters/belle_neutral.png">>
<<linkreplace " Continue ▶ ">>
<<say "nico" "and you should be proud, you're a natural!" "images/characters/nico_smile.png">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "grandpaaaa" "cute">>

[["David was sleeping at home, maybe he didn't know you would be here?"]]
[["David was sleeping at home. Let's go ask him." ->"David was sleeping at home, maybe he didn't know you would be here?"]]
[["David was sleeping at home. Let's go ask him. AND you can take a warm bath."]]

<</linkreplace>>
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>
<</linkreplace>>


:: Lissa's cabin {"position":"1750,1925","size":"100,100"}
<<if !$backpack.has("quirogaskeys")>>
  Lissa's cabin isn't far from Bastet's. It's a bit bigger than hers because it has been here for longer, and who knows who built it.
  All the lights are off, and the door is closed. The windows are foggy, you can't see inside. 
  <<return>>
  <<else>>
    All the lights are off, the door is closed, and the windows are foggy, you can't see inside. 
    It doesn't even look like she's home...

    <<linkreplace "Open the door with the key">>
    You open the door, and it creaks loudly, but no one answers. Walking in, you notice that there's a faint light coming from upstairs.
     [["Lissa?"]]
     [[Attempt to go to the kitchen, get the ingredients and flee.->Lissa's kitchen]]
   <</linkreplace>>
    <</if>>


:: Lissa's kitchen {"position":"2075,1825","size":"100,100"}
<<if !$lightsOn>>
You walk into the dark kitchen, it's cold, but at least everything seems to be clean and organized. 
You quickly look inside the cabinets for the ingredients and get some <div id="bakingpickup"></div>
<<nobr>>
<<if !$backpack.has("flour") and !$backpack.has("sugar")>>
	<<linkreplace "flour and sugar">>
		<<replace "#bakingpickup">>
			<<pickup $backpack "flour" 1>>
			<<pickup $backpack "sugar" 1>>
			<p>You picked up the flour and sugar.</p>
		<</replace>>
	<</linkreplace>>
<</if>>
<</nobr>>

[[Back outside->Back to Bastet's]]
<</if>>

<<if $lightsOn>>
You walk into the kitchen, it's cold, but at least everything seems to be clean and organized.
You quickly look inside the cabinets for the ingredients and get some 
<<nobr>>
<div id="bakingpickup"></div>
<div id="chocolatepickup"></div>
<<if !$backpack.has("flour") and !$backpack.has("sugar")>>
	<<linkreplace "flour and sugar">>
		<<replace "#bakingpickup">>
			<<pickup $backpack "flour" 1>>
			<<pickup $backpack "sugar" 1>>
			<p>You picked up the flour and sugar.</p>
		<</replace>>
	<</linkreplace>>
<</if>>
<</nobr>>

	<<linkreplace " Continue ▶ ">>
		<<replace "#chocolatepickup">>
			<p>But then...you notice something on the counter. It's a bar of chocolate. Bastet didn't ask for it, but it might be useful.</p>
			<<linkreplace "Take the chocolate">>
				<<replace "#chocolatepickup">>
					<<pickup $backpack "chocolate" 1>>
					<p>You took the chocolate.</p>
					[[Back to Bastet's]]
				<</replace>>
			<</linkreplace>>
		<</replace>>
	<</linkreplace>>
<</if>>

<<if $backpack.has("flour")>>
	[[Back to Bastet's]]
<</if>>



:: Listen [failtry] {"position":"1475,1575","size":"100,100"}
You press your ear against it; you hear a loud purring and music playing in the background, as if it were three rooms away.80s music, or so they call it in Aquari.

Whoever's inside wouldn't hear you knock over the noise.

<<return>>


:: Living Room {"position":"675,975","size":"100,100"}

<<if !$davidAwake>>
You walk down the stairs to the living room, but wait, what's that sound? Is that...snoring?
David is taking the deepest nap you have ever seen in the sofa. Uninvited. 
[[Try to wake David->Try to wake him up]]
[[Front door/Go outside->Heather's outside]]
[[Upstairs, Bedroom |Bedroom]]
[[Kids Bedroom |Kids Bedroom]]
<<else>>
  No more snores in the living room
[[Front door/Go outside->Heather's outside]]
[[Upstairs, Bedroom |Bedroom]]
[[Kids Bedroom |Kids Bedroom]]
  <</if>>
<<if !$hadBreakfast>>
[[Eat breakfast]]
<</if>>


:: Eat breakfast {"position":"700,1000","size":"100,100"}

You walk to the kitchen, in the table there's s capuccino and three sandwiches waiting for you.
<<linkreplace " Eat breakfast ">>
  Nomnom
<<set $hadBreakfast = true>>
<<return>>
<</linkreplace>>


:: Living room {"position":"2000,3025","size":"100,100"}
As you predicted earlier, the living room is strangely quiet, even though there's a game playing on the old TV, it´s in the main menu, there´s two controllers connected. There's somw white gloves in the coffe table and some fingerless black gloves...
<<linkreplace " Continue ▶ ">>
<<say "dot" "It's Joy karts!" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "aaah but we're looking for mom..." "sad">>
<<linkreplace " Continue ▶ ">>
<<say "dot" "yeah, but maybe we can ask Kino to play later." "smile">>
<<return>>
<</linkreplace>><</linkreplace>><</linkreplace>>


:: Look for Herb {"position":"1950,2325","size":"100,100"}

If Herb went to get the ingredients, then maybe it's not worth going through the trouble of getting more yourself. But...it's impossible to go look for him if you don't even know if he's in Aquari or not.
<<return>>

:: Lucius' office {"position":"2275,2975","size":"100,100"}
On the door to Lucius's office is a golden peace dove...well, not gold, golden.

<<if !$helpedNina>>
When you knock and enter, you don't find the leader as you thought. No, there's the small, square robot, Jim, dusting every corner, on the bookcases, under the desk. All the furniture has been moved to reach the farthest corners.
<<linkreplace " Continue ▶ ">>
<<say "Jim" "Ah!, Mordred!">>
Putting the cleaning supplies aside, the powerful robot puts the furniture back in place as efficiently as possible, like a Tetris game.
The little robot approaches you, looking up.
<<linkreplace " Continue ▶ ">>
<<say "Jim" "What can I do for you? Do you want a drink? Something to eat, perhaps?">>
Despite having a programmed voice, Jim has a Beckerevian accent. 
<<linkreplace " Continue ▶ ">>
  <<if $backpack.has("book")>>
	<p>You take out the book...</p>
	[[Could you help Nina with this?]]
  <<else>>
    <<say "mordred" "No, thank you, I'm alright. Have you seen Otta?" "happy">>
    <<linkreplace " Continue ▶ ">>
      <<say "jim" "I'm sorry to say I haven't.">>
      <<return>>
      <</linkreplace>>
  <</if>>
<</linkreplace>><</linkreplace>><</linkreplace>>
<<else>>
  The office is pristine clean, and Jim isn't here anymore.
  <</if>>


:: Meriem's mansion {"position":"1975,2900","size":"100,100"}
[[Dome(back to start)->Dome1]]

[[Living room]]
[[Library]]

<<linkreplace "Kitchen and dining">>
Bastet and company have left. And it's better not to give Belle time to look through the fridge.
<</linkreplace>>

:: Nah {"position":"2900,3200","size":"100,100"}
<<say "tony" "Oh...if you find him can you tell me where he is? thank you" "smile">>
<<return>>
[[Back Garden]]


:: Nina {"position":"2400,3250","size":"100,100"}
<<if !$helpedNina>>
<<say "nina" "Oh, hello Mordred." "akward">>
<<linkreplace " Continue ▶ ">>
<<say "nina" "I was just...looking for a book, but they're all in beckerevian." "annoyed">>
<<linkreplace " Continue ▶ ">>
<<say "nina" "Dia is busy but I really need to find this book...can you help me somehow? call someone else?" "akward">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "Sure, I'll try" "smile">>
  <<linkreplace " Continue ▶ ">>
    <<say "nina" "Thank you" "akward">>
    <<linkreplace " Continue ▶ ">>
      <<say "mordred" "What book are you looking for?" "thinking">>
      <<linkreplace " Continue ▶ ">>
        <<say "nina" "Well...We're working in a project so I'm studying genetics. " "embarrassed">>
        <<linkreplace " Continue ▶ ">>
          <<say "mordred" "I see, I'll find someone to translate for you" "akward">>
          <<linkreplace " Continue ▶ ">>
          <<say "nina" "Here, take it, maybe you can show it so they know what I'm up to before walking all the way here..." "akwardsmile">>
          <<silently>>
          <<if !$backpack.has("book")>>
          <<pickup $backpack "book" 1>>
          <</if>>
           <</silently>>
          <<linkreplace " Continue ▶ ">>
            <<say "mordred" "(So the book is here but Nina needs someone to translate for her...)" "thinking">>
            <<return>>
              <</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>
              <<else>>
                Jim is writing down the whole book in your universal language. Nina isn't here.
                You don't want to bother him.
                <<return>>
              <</if>>


:: Observatory {"position":"2400,3125","size":"100,100"}
The observatory is the highest room in the mansion. The walls are covered in wood, and the dome is painted like space. The telescope is enormous, and there are books scattered on the tables; one of the computers is still on. But there's no one here.
Belle attempts to use the telescope, but Dot warns her that if she looks at the sun, she´ll go blind.
<<linkreplace " Continue ▶ ">>
After hearing that, Belle won't even risk using a telescope at night.
<<return>>
<</linkreplace>>

:: Open the door [failtry] {"position":"1225,1575","size":"100,100"}
It's locked.
<<return>>

:: Otta's note {"position":"1100,750","size":"100,100"}

//<span class="Caveat">"I'm out with Dot doing some chores. Can you pick up Belle from your dad's?, make sure to eat breakfast first! You'll need it!"</span> <span class="emojifont">❤️</span>//
<<linkreplace " Continue ▶ ">>
  <<set $readNote = true>>
 <<say "mordred" "I'll need it?" "thinking">>
<<linkreplace " Continue ▶ ">>
 <<say "mordred" "Ah, because of launch day?" "thinking">>
<<linkreplace " Continue ▶ ">>
 Mordred and Otta are helping people moving to Mars, day and night of moving packages through portals. And today it's ''Launch day'', meaning that more people will be sent to live in Mars. It's a busy day.
 But before the actual launch, there will be a party in the Dome's hangar.
 [[Continue->Bedroom]]
 <</linkreplace>>
  <</linkreplace>>
   <</linkreplace>>


:: Samira's cabin {"position":"2050,2125","size":"100,100"}
It's kind of crazy that both, Samira and Bastet, ended up living in this same snowy forest after Mordred haven't seen them for so long.
 Samira and Grandad got here before Bastet and they built their cabin themselves too...well, mostly Grandad. He was escaping from the mess he made in Orts.
 Good thing that Daxi is the new ruler. 

 <<linkreplace " Continue ▶ ">>
  The lights are on, and the door is open. But when you're about to knock, you hear something in the backyard...
  <<linkreplace " Continue ▶ ">>
 <<say "grandad" "Let me do it.">>
 <<linkreplace " Continue ▶ ">>
  Followed you hear a loud roar, followed by loud thud and Quiroga, saying;
  <<linkreplace " Continue ▶ ">>
  <<say "quiroga" "Sure." "neutral">>
  [[Take a peek around the corner]]
  <</linkreplace>>  <</linkreplace>> <</linkreplace>> <</linkreplace>>


:: Samira's kitchen {"position":"1900,1575","size":"100,100"}

 You walk into the kitchen, your arms sore from lifting the rock. What a waste of time. 
 In the wall cabinet you see a lot of hanging herbs.
 And opening the fridge(powered by magic) first you see one of those giant snails, but that's not what you need, you take out the eggs, butter, and milk.
 Cheking the pantry, taking things out, you find no flour or sugar. 
 <<pickup $backpack "eggs" 1>>
 <<pickup $backpack "butter" 1>>
 <<pickup $backpack "milk" 1>>
[[Go back outside->Grandad and Quiroga2]]

:: Shake him [failtry] {"position":"575,1400","size":"100,100"}
<<say "david" "......" "images/characters/david_asleep.png">>
It's no use.
<<return>>


:: Snowy forest {"position":"1575,2125","size":"100,100"}
Everyone comes out of the portal, the temperature difference is noticeable, but everyone is dressed warmly enough. The cats don't seem so happy, except for Penelope, as Belle runs through the snow, Penelope follows, jumping like an artic fox hunting.
<<linkreplace " Continue ▶ ">>
  <<say "david" "let's go inside quick please!" "images/characters/david_cold.png">>
They all start walking towardS Bastet's house, which isn't that far away, it's easy to see between the trees.
  <<linkreplace " Continue ▶ ">>
    <<say "belle" "why does Bastet have to live so faaaaaaaaaaaar?" "screaming">>
    <<linkreplace " Continue ▶ ">>
     <<say "mordred" "It's not that far! it takes longer to walk to Metis from our house." "laughing">>
    <<linkreplace " Continue ▶ ">>
      <<say "belle" "...oh that's true. But it's cold here" "neutral">>
      [[Bastet's]]
<</linkreplace>> <</linkreplace>> <</linkreplace>>  <</linkreplace>>


:: Snowy forest2 {"position":"1825,2125","size":"100,100"}
You go outside with an extra jacket from Herb that Bastet lent you. It's new, so it still has both arms, he haven't used it at all.
 The portal has a bit of cooldown, so it's no use going anywhere else to get the ingredients.
 [[Look around for Herb->Look for Herb]]
 [[Go to Lissa's cabin->Lissa's cabin]]
 [[Go to Samira's cabin->Samira's cabin]]

:: Start {"position":"800,675","size":"100,100"}
Mordred wakes up to a warm morning sun hitting his face. Reaching for the side of the bed he notices that Otta isn’t there.

[[Get up->Bedroom]]


:: StoryBanner {"position":"150,500","size":"100,100"}
<img src="images/characters/banner.png">

:: StoryCaption {"position":"150,750","size":"100,100"}
Inventory
<<inv $backpack use inspect>>

:: StoryDisplayTitle {"position":"150,625","size":"100,100"}
Mordred's completely normal day

:: StoryInit {"position":"150,375","size":"100,100"}

<<newinv $backpack>>
<<newinv $party>>

 Variables
<<set $dressed = false>>
<<set $readNote = false>>
<<set $helpedNina = false>>

CAT ADVENTURE VARIABLES
<<set $foundLoretta = false>>
<<set $foundSabrina = false>>
<<set $foundDiana = false>>
<<set $foundSabrina = false>>
<<set $foundPenelope = false>>
<<set $foundAllCats = false>>
<<set $clueDiana = false>>
<<set $davidAwake = false>>

Items
<<item "crab" "Crab">>
<<description>>
It's a crab's skeleton that Belle gifted you.
<<permanent>>
<</item>>
<<item "belle" "Belle">>
<<description>>
She's in your party, not your inventory, but she likes to imagine she's small enough to fit in your pocket.
<<unique>>
<</item>>
<<item "flour" "Flour">>
<<description>>
  This should do for an extra cake.
<<unique>>
<</item>>
<<item "eggs" "Eggs">>
<<description>>
  Some regular chicken eggs.
<<unique>>
<</item>>
<<item "sugar" "Sugar">>
<<description>>
  Sweet!
<<unique>>
<</item>>
<<item "butter" "Butter">>
<<description>>
  Yum
<<unique>>
<</item>>
<<item "chocolate" "Chocolate">>
<<description>>
 Would make almost anyone happy.
<<unique>>
<</item>>
<<item "quirogaskeys" "Quiroga's Keys">>
<<description>>
 There are three keys in the ring. Two of them have eyes engraved on them, one is Lissa's cabin's, the other, Tanar's church, the third one, you have no idea.
<<unique>>
<</item>>
<<item "waterbucket" "Water Bucket">>
<<unique>>
<</item>>
<<item "airhorn" "Air Horn">>
<<description>>
  It's loud, David has used this to jumpscare you in the past multiple times.
<<unique>>
<</item>>
<<item "book" "Book">>
<<description>>
  A genetics book. It's in Beckerevian. 
<<unique>>
<</item>>
<<item "milk" "Milk">>
<<description>>
  Milk
<<unique>>
<</item>>
  <<cacheaudio "bass" "bleeps/bass.ogg">>
   <<cacheaudio "surprise" "bleeps/surprise.ogg">>
<<script>>

window.sounds = {
  click: new Audio("bleeps/click.ogg"), // reemplaza con tu ruta real
  meow: new Audio("bleeps/meow.ogg"),
  // agrega más si quieres
};

$(document).on('click', 'a.link-internal, .link-external, .link-replace, .link-append', function (event) {
	if (window.sounds?.click) {
		window.sounds.click.currentTime = 0;
		window.sounds.click.play();
	}
});
<</script>>



:: TOOOT! [success] {"position":"1100,1725","size":"100,100"}
The music on the other side of the door stops, It sounds like someone stopped a record player by lifting the needle.. 
<<linkreplace " Continue ▶ ">>
The door opens to reveal Malik, who you barely know, he holds a cat under his arm.
<<linkreplace " Continue ▶ ">>
<<say "belle" "WHO EVEN IS THAT BALD CAT?" "screaming">>
<<linkreplace " Continue ▶ ">>
<<say "malik" "Don't be mean, kid, this is my cat, Fuzzy!" "smile">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "...aah..Fuzzy, but it´s bald, I see what you did there..." "really">>
<<linkreplace " Continue ▶ ">>
<<say "malik" "Hilarious, I know. So..eh...what's up?" "happy">>
[["Why do you have a magic door here?"]]

<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Take a peek around the corner {"position":"2300,2125","size":"100,100"}
You take a peek around the corner and...you see Grandad suplexing a waterdog.
<<linkreplace " Continue ▶ ">>
  The waterdog is as big as a rote, it has a long slimy body and countless needle teeth, after being suplexed, it twists in the snow like a fish out the water.
<<linkreplace " Continue ▶ ">>
  Both Quiroga and Grandad look down at it blankly for a few moments that feel like an eternity. 
  <<linkreplace " Continue ▶ ">>
    Then, Quiroga opens his third eye and the waterdog is launched to the sky.
     When it falls back down(and somehow doesn't explode from the pressure), Grandad launches it again.
<<linkreplace "Continue watching">>
This time, the waterdog is taking strangely long to fall back down. You don't dare to look up. Quiroga turns to see Grandad.
<<linkreplace " Continue ▶ ">>
  <<say "quiroga" "I believe you're stronger." "neutral">>
  <<linkreplace " Continue ▶ ">>
    <<say "grandad" "Yes." "neutral">>
    <<linkreplace " Continue ▶ ">>
      <<say "quiroga" "We have to find a better way to measure strength." "neutral">>
      <<linkreplace " Continue ▶ ">>
        <<say "grandad" "A bigger waterdog." "neutral">>
        <<linkreplace " Continue ▶ ">>
          <<say "quiroga" "Yes,maybe...Maybe not alive." "neutral">>
          <<linkreplace " Continue ▶ ">>
            <<say "quiroga" "If Lissa and Samira see-" "neutral">>
            <<linkreplace " Continue ▶ ">>
              <<say "grandad" "Then we kill it beforehand." "neutral">>

              [[Interrumpt them once and for all->Interrumpt them]]

<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Tena's stable {"position":"1100,1600","size":"100,100"}
  <<if !$foundSabrina || $foundDiana || $backpack.has("waterbucket") || $davidAwake>>
The stable is warm despite the humidity. Tena sleeps on the straw, her fat belly moving up and down peacefully. On her back is a little bird eating bugs from her fur, which flies away when it sees you.
[[No need to wake her up->Heather's outside]]
<</if>>

<<if $clueDiana && !$backpack.has("waterbucket") && !$foundDiana>>
  The stable is warm despite the humidity. Tena sleeps on the straw, her fat belly moving up and down peacefully. On her back is a little bird eating bugs from her fur.
  <<linkreplace " Continue ▶ ">>
  Then, from the shadows, Diana jumps in an attempt to hunt the bird, but it flies away before she can catch it and rolls over Tena's belly instead. She falls right into a waterbucket and screetches loudly.
   Tena slowly wakes up, looking to her belly. 
 [[Found Diana]]
  <</linkreplace>>
  <</if>>


:: TestRoom {"position":"450,700","size":"100,100"}
[[Start]]
[[Intro]]
-------------------

Inventory testing

<<link "quirogas keys">>
<<pickup $backpack "quirogaskeys" 1>>
<</link>>
<<link "crab">>
<<pickup $backpack "crab" 1>>
<</link>>
<<link "waterbucket">>
<<pickup $backpack "waterbucket" 1>>
<</link>>



-----------
*Puzzles*

[[Frau_Quiz1]]
[[Click speed]]
[[Word Scramble]]

<<link "Pet the cat">>
<<run sounds.meow.currentTime = 0; sounds.meow.play();>>
It meows happily!
<</link>>

----------------


Password, secret

What's the password?
<<textbox "$password" "">>\
<<link "Confirm Password">>\
<<replace "#passwordArea">>\
<<if $password.toLowerCase() == "secret">>
  Correct password!
<<else>>
  Incorrect password.
<</if>>\
<</replace>>
<</link>>
<div id="passwordArea"></div>

<hr>
Items



<hr>

<<linkreplace "Dialogue effects">>
<<say "mordred" "¡<span class='vibrate'>vibrate</span> <span class='blink'>blink</span> <span class='tilt'>tili</span> <span class='wave'>wave</span> <span class='vibrate wave'>vibrate wave</span>" "images/characters/mordred_happy.png">>
<</linkreplace>>

<<say "lesle" "<p class='emojifont'>👋</p><p class='asl'>sup im drawing</p>" "smile">>

<<say "lesle" "<p class='asl'>sup im drawing</p>" "smile">>


		<p class="dotfont">3. heal, heal, frog butt</p> <p class="emojifont">🐸</p>

<<timed 5s t8n>>
<<script>>
confetti(); // Lanza confetti básico
<</script>>
<</timed>>

<<link "confetes">><<script>>confetti(); // Lanza confetti básico<</script>> <</link>>

:: To Metis {"position":"1225,1375","size":"100,100"}
It's the weekend, and Metis is quiet, but there seems to be some movement in the shops and houses.
You're walking along the cobblestone path when you notice a faint glow coming from a dark alley, and hear a loud <<link "MEOW">>
<<run sounds.meow.currentTime = 0; sounds.meow.play();>>
<</link>>.
[[Investigate]]
[[Go to Nico's]]
[[Go back home->Heather's outside]]


:: To the hangar {"position":"2700,2400","size":"100,100"}
                <<if not hasVisited("Frau_Quiz1")>>
With Belle and Dot, you decide to go check on the launch day preparations, but then...
 <<say "frau" "Mordred!!" "smile">>
 [["Have you seen Otta?"->Frau_Otta]]
 [["What are you doing here?"->Frau_WhatYouDoing]]
 <</if>>
                <<if hasVisited("Frau_Quiz1")>>
[[I want to try the quiz again->Frau_Quiz1]]
<</if>>


:: ToTheDome {"position":"2075,2450","size":"100,100"}
<<silent>>
<<drop $backpack "flour" 1>>
<<drop $backpack "eggs" 1>>
<<drop $backpack "butter" 1>>
<<drop $backpack "milk" 1>>
<<drop $backpack "sugar" 1>>
<</silent>>
To your surprise, Amber, David and the cats aren't here anymore. 
Belle and Bastet don't notice you come in, they're still cooking. Belle pours salsa in a pizza, Bastet lays the cheese in it evenly and puts it in the oven. Herb immediately starts helping out. When everything is almost done, Grandad arrives, and with no ordreds given he helps take the food to The Dome.
Everyone goes to the portal together.

<<linkreplace " Continue ▶ ">>
On The Dome's side, the portal is still in the basement, once again there's a temperature difference. 
Youo go upstairs with everyone else and leave the food in the kitchen, it's...strangely silent for the time it is. By experience, at this time, there will be a scientist or two messing around here or in the second floor, but not even a sigh is heard.
<<linkreplace " Continue ▶ ">>
 Herb, Bastet, Grandad and Angelus are talking to the side and you can't help but feel a little left behind.
 <<linkreplace " Continue ▶ ">>
 <<say "belle" "DAD" "screaming">>
  <<pickup $backpack "belle" 1>>
 <<linkreplace " Continue ▶ ">>
 <<say "belle" "Come on let's go out and do something while they work, cause that's BORING" "bored">>
 [["We should help them, there might be a lot to set up"]]
 [["Sure, you want to go see the animals?"]]
 [["Sure, what do we do?"]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Tony, Have you seen Otta? {"position":"2775,3075","size":"100,100"}
<<say "tony" "Hey bros" "happy">>
<<linkreplace " Continue ▶ ">>
<<say "belle" "we're not 'bros'!" "really">>
<<linkreplace " Continue ▶ ">>
<<say "tony" "ah!...sorry" "nervious">>
<<linkreplace " Continue ▶ ">>
<<say "mordred" "Hey, have you seen Otta?" "thinking">>
<<linkreplace " Continue ▶ ">>
<<say "tony" "aah..Otta...yeah, no I haven't, but have you seen Johnny?" "neutral">>
<<if hasVisited("Lake")>>[[Yeah!]]<</if>>
[[Nah]]

[[Back Garden]]

<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: Try to wake him up {"position":"550,1125","size":"100,100"}
What do you want to do?

[[Shake him]]
[[Call him softly]]
[[DAVID!!]]
[[Return->Living Room]] 

<<if hasVisited("DAVID!!") || !$backpack.has("waterbucket")>>
   Maybe there's something you can use to wake him up.
<</if>>

<<if $backpack.has('waterbucket')>>
  <div id="pickupWater">
  <<link "Use the water bucket!">>
    <<replace "#pickupWater">>
             <<drop $backpack 'waterbucket' 1>>
       [[Wake David up once and for all.]]
        <</replace>>
    <</link>>
    </div>
<</if>>

:: Upstairs {"position":"2275,3125","size":"100,100"}
The spiral staircase leading to the other floors of the mansion is in the library. They're so elegant, with their polished wooden railings engraved with flowers, that it's almost scary to use them. But luckily, the steps show the wear of the shine from use.

[[Go back downstairs->Library]]
[[Lucius' office]]
[[Classroom]]
[[Observatory]]


:: Wake David up once and for all. [success] {"position":"975,1725","size":"100,100"}
<<say "david" "AAAAAAAAAAAA" "images/characters/david_screaming.png">>
    <<linkreplace " Continue ▶ ">>
    When David gets up quickly,<<linkreplace "something falls from his pocket.">> 
    It's an  <<if !$backpack.has('air horn')>><<link "air horn!">><<pickup $backpack "airhorn" 1>><<goto GotAirHorn>>
	<</link>>
<</if>>
<</linkreplace>> <</linkreplace>>


:: Wardrove {"position":"925,675","size":"100,100"}
As you get up and walk to the wardrove, you notice a piece of paper stick in the door. It has hearts in the corners. It must be from one of Belle's notebooks, but the handwriting is Otta's.

[[Dress up]]
[[Otta's note]]
[[Bedroom]]


:: With all cats found,go back home {"position":"1225,2125","size":"100,100"}
You found all cats!
<<linkreplace " Continue ▶ ">>
 <<say "david" "I can't believe that just happened" "images/characters/david_wideeyed.png">>
 <<linkreplace " Continue ▶ ">>
 <<say "amber" "It's alright, we found them all, I'll dry up Diana" "smile">>
<<linkreplace " Continue ▶ ">>
  <<say "belle" "Now we can take them all and show auntie Bastet!" "smile">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "You're taking a bath first" "surprised2">>
<<linkreplace " Continue ▶ ">>
  <<say "mordred" "(something weird is up today...)" "thinking">>
<<linkreplace " Continue ▶ ">>
  As you prepare the bathtub for Belle, Amber dries Diana's fur, who ends up all nice and fluffy. Meanwhile, David is keeping all the cats in the living room.
  Mordred can't help but think that something is up today, but on the other hand, their silly shenanigans are an everyday thing, so he shrugs it off. Still...Otta should be home by now.
   He doesn't want to go to Bastet's with no warning.
  <<linkreplace " Continue ▶ ">>
    <<say "mordred" "We're showing Bastet the cats too?" "thinking">>
    <<linkreplace " Continue ▶ ">>
    <<say "belle" "YES, dad, she'll love them! DUH">>
    <<linkreplace " Continue ▶ ">>
    <<say "mordred" "But was it arranged? Is she waiting for us?" "suspicious">>
    <<linkreplace " Continue ▶ ">>
      <<say "david" "Of course it is!, we've been planning this for weeks, right Belle?" "images/characters/david_smile.png">>
      <<linkreplace " Continue ▶ ">>
        <<say "belle" "YESSSS!! I can't wait! shoo, let me bath already!thanks dad this is enough waterr!!!" "screaming">>
      <<linkreplace " Continue ▶ ">>
        While Belle bathes, David and Amber prepare the cats to go to Bastet's, asking each other which collar was who's.
         Mordred watches, and has a quick talk with David about what is up, but he answers as expected, that everything is fine and it's just a cat showdown. 
         He decides to leave a note for Otta:
         <<textarea "$note" "">>
[[Continue->Basement]]  

<</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>> <</linkreplace>>


:: Word Scramble {"position":"1975,2725","size":"100,100"}
<!-- 1 -->
<<nobr>>
<p class="lissafont">1. ROEHS</p>
<div id="step1">
	<<textbox "$answer1" "">>
	<<link "Confirm">>
		<<replace "#step1">>
			<<if $answer1.toLowerCase() == "horse">>
				<p class="dotfont">1. Horse</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer1" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 2 -->
<p class="lissafont">2. DBRI</p>
<div id="step2">
	<<textbox "$answer2" "">>
	<<link "Confirm">>
		<<replace "#step2">>
			<<if $answer2.toLowerCase() == "bird">>
				<p class="dotfont">2. Bird</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer2" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 3 -->
<p class="lissafont">3. GLOIARLTA</p>
<div id="step3">
	<<textbox "$answer3" "">>
	<<link "Confirm">>
		<<replace "#step3">>
			<<if $answer3.toLowerCase() == "alligator">>
				<p class="dotfont">3. Alligator</p>
			<<else>>
				<p>Try again.</p>
				<<textbox "$answer3" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 4 -->
<p class="lissafont">4. TNPLEHEA</p>
<div id="step4">
	<<textbox "$answer4" "">>
	<<link "Confirm">>
		<<replace "#step4">>
			<<if $answer4.toLowerCase() == "elephant">>
				<p class="dotfont">4. Elephant</p>
			<<else>>
				<p> Try again.</p>
				<<textbox "$answer4" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>

<!-- 5 -->
<p class="lissafont">5. ABITRB</p>
<div id="step5">
	<<textbox "$answer5" "">>
	<<link "Confirm">>
		<<replace "#step5">>
			<<if $answer5.toLowerCase() == "rabbit">>
				<p class="dotfont">5. Rabbit</p>
				[[Continue->Homework2]]
			<<else>>
				<p> Try again.</p>
				<<textbox "$answer5" "">>
			<</if>>
		<</replace>>
	<</link>>
</div>
<</nobr>>


:: Yeah! {"position":"2775,3200","size":"100,100"}
<<say "mordred" "we saw him before in the lake.">>

Tony stands up and throws the guitar over his shoulder, holding it on his back by the strap.

<<linkreplace " Continue ▶ ">>

<<say "tony" "Gracias!, gonna meet with him now." "smile">>

<<linkreplace " Continue ▶ ">>

<<say "belle" "where is Ralis?" "thinking">>

<<linkreplace " Continue ▶ ">>

<<say "tony" "Ah, he went to see his family, but we just had a concert so I had to replace him..." "neutral">>

<<linkreplace " Continue ▶ ">>

<<say "tony" "Novi was leading today, she sang a song called Spiderwebs. It was great." "smile">>

<<linkreplace " Continue ▶ ">>

<<say "belle" "aww...dad, can we go watch them next time they play?" "sad">>

<<linkreplace "Sure, why not?">>

<<say "tony" "Hey, you might see us play before you think. See ya'll later" "smile">>

<<linkreplace " Continue ▶ ">>

<<say "tony" "Lesle you coming?" "smile">>

Lesle completely ignores Tony, he almost seems deaf as he's concentrated in drawing in his whiteboard.

When Tony taps his shoulder, Lesle smacks him with the whiteboard. 

<<linkreplace " Continue ▶ ">>

<<say "tony" "auch! bro! what the...okay but don't be late!" "angry">>

Tony leaves, and Lesle looks up at you. 

[[Lesle, Have you seen Otta?]]
[[Gardens]]
<</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>><</linkreplace>>


:: _useItem {"position":"150,875","size":"100,100"}
<<set $itemToUse = _args[0]>>
<<run Engine.show(State.passage)>>


:: StoryScript [script]

var script = document.createElement('script');
script.src = 'https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js';
script.defer = true;
document.head.appendChild(script);



/* twine-user-script #1: "StoryScript" */
(function () {
    'use strict';

    var characters = new Map();

    // Para guardar el ID del intervalo activo (solo uno a la vez)
    let typingIntervalId = null;

    // Para guardar la función que limpia el intervalo (cancelar el tipeo)
    function cancelTyping() {
        if (typingIntervalId !== null) {
            clearInterval(typingIntervalId);
            typingIntervalId = null;
        }
    }

    function addCharacter(name, displayname, icon) {
        if (icon === undefined && displayname) {
            icon = displayname;
            displayname = null;
        }
        if (State.length) {
            throw new Error('addCharacter() -> debe llamarse antes de que empiece la historia');
        }
        if (!name || !icon) {
            console.error('addCharacter() -> argumentos inválidos');
            return;
        }
        if (characters.has(name)) {
            console.error(`addCharacter() -> sobrescribiendo personaje "${name}"`);
        }
        characters.set(name, { displayName: displayname, image: icon });
    }

    function say($output, character, text, imgSrc) {
        // Cancela cualquier tipeo anterior antes de comenzar otro nuevo
        cancelTyping();

        var $box = $('<div>')
            .addClass(Util.slugify(character) + ' say');

      // Si no se especifica una emoción o ruta, usar 'neutral'
let finalSrc = imgSrc || 'neutral';

// Si no contiene "/", lo tratamos como emoción
if (!finalSrc.includes('/')) {
    const slug = Util.slugify(character); // ej: "Frau" -> "frau"
    finalSrc = `images/characters/${slug}_${finalSrc}.png`;
}

var $img = $('<img>').attr('src', finalSrc);


        if ($img.attr('src') && $img.attr('src').trim()) {
            $box.append($img);
        }

        var _name = character.toUpperFirst();
        if (characters.has(character) && characters.get(character).displayName) {
            _name = characters.get(character).displayName;
        }

        $box.append($('<p>').wiki(_name));

        var $textBox = $('<p>')
            .attr('data-type-text', text)
            .attr('data-type-delay', '30ms')
            .addClass('typeText');

        $box.append($textBox);

        if ($output) {
            if (!($output instanceof $)) {
                $output = $($output);
            }
            $box.appendTo($output);
        }

        // Pasamos el ID del intervalo para poder cancelarlo después
        typeWithSound($textBox, text, 30, character);

        return $box;
    }

    function typeWithSound($el, html, delay, character) {
        const container = document.createElement('div');
        container.innerHTML = html;

        const audioSrc = `bleeps/bleep_${character}.ogg`;
        const fallbackSrc = `bleeps/bleep_default.ogg`;

        function playBleep() {
            const audio = new Audio(audioSrc);
            audio.onerror = () => new Audio(fallbackSrc).play();
            audio.play().catch(() => new Audio(fallbackSrc).play());
        }

        function typeNode(node, parent) {
            if (node.nodeType === Node.TEXT_NODE) {
                const text = node.textContent;
                let i = 0;
                const span = document.createElement('span');
                parent.appendChild(span);

                // Guardamos el intervalo global para poder cancelarlo
                typingIntervalId = setInterval(() => {
                    if (i >= text.length) {
                        clearInterval(typingIntervalId);
                        typingIntervalId = null;
                        typeNext();
                        return;
                    }
                    const char = text[i++];
                    span.append(char);
                    if (char.match(/[^\s]/)) playBleep();
                }, delay);

            } else if (node.nodeType === Node.ELEMENT_NODE) {
                const el = node.cloneNode(false);
                parent.appendChild(el);
                const children = Array.from(node.childNodes);
                let index = 0;

                function nextChild() {
                    if (index >= children.length) {
                        typeNext();
                        return;
                    }
                    typeNode(children[index++], el);
                }
                nextChild();
            } else {
                typeNext();
            }
        }

        const nodes = Array.from(container.childNodes);
        let nodeIndex = 0;

        function typeNext() {
            if (nodeIndex >= nodes.length) return;
            typeNode(nodes[nodeIndex++], $el[0]);
        }

        typeNext();
    }

    // Cancelar cualquier tipeo al cambiar de pasaje para evitar que siga sonando
    $(document).on(':passagestart', () => {
        cancelTyping();
    });

    window.addCharacter = addCharacter;
    window.say = say;

    Macro.add('say', {
        handler() {
            const character = this.args[0];
            const text = this.args[1];
            const imgSrc = this.args.length > 2 ? this.args[2] : null;

            if (!character || !text) {
                return this.error('Uso: <<say "personaje" "texto" ["imagen"]>>');
            }

            say(this.output, character, text, imgSrc);
        }
    });

    window.addCharacter = addCharacter;
    window.say = say;
})();


Macro.add("saybox", {
	tags: null,
	handler() {
		const boxId = this.args[0] || "say-slot"; // Si no se pasa un ID, usa "say-slot"
		const content = this.payload[0].contents;
		// Insertar el contenedor con el ID
		const html = `<div id="${boxId}" class="saybox">${content}</div>`;
		new Wikifier(this.output, html);
	}
});

Array.prototype.delete = function(item) {
	const index = this.indexOf(item);
	if (index > -1) {
		this.splice(index, 1);
	}
	return this;
};

Macro.add("clickbar", {
	handler() {
		// Parámetros
		const targetClicks = parseInt(this.args[0]) || 20; // clics necesarios
		const decaySpeed = parseInt(this.args[1]) || 400; // velocidad de caída
		const linkTarget = this.args[2] || "Next"; // pasaje al que ir
		const barId = "clickbar-" + Math.random().toString(36).substr(2, 9); // id único

		// Estado local
		let clicks = 0;
		let interval;

		// HTML
		const wrapper = document.createElement("div");
		wrapper.innerHTML = `
			<div style="margin:1em 0;">
				<div id="${barId}-bar" style="height:20px; background:#ccc; border-radius:10px; overflow:hidden;">
					<div style="width:0%; height:100%; background:#4caf50; transition:width 0.1s;" id="${barId}-fill"></div>
				</div>
				<button id="${barId}-btn" style="margin-top:0.5em;">Click!</button>
			</div>
		`;

		this.output.append(wrapper);

		// Elementos DOM
		const btn = wrapper.querySelector(`#${barId}-btn`);
		const fill = wrapper.querySelector(`#${barId}-fill`);

		function updateBar() {
			const percent = Math.min(100, (clicks / targetClicks) * 100);
			fill.style.width = percent + "%";
		}

		function decay() {
			interval = setInterval(() => {
				if (clicks > 0) {
					clicks--;
					updateBar();
				}
			}, decaySpeed);
		}

		btn.addEventListener("click", () => {
			clicks++;
			updateBar();

			if (clicks >= targetClicks) {
				clearInterval(interval);
				wrapper.innerHTML = "";
				new Wikifier(wrapper, '[[Good enough]]');
			}
		});

		decay();
	}
});


// Simple Inventory, for SugarCube 2, by Chapel
// v3.0.1, 2024-07-22, 8c9749dbafa5f12948d743a8dedd4e1c74bb9e26
;"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}!function(){var t={description:"",handler:null,displayName:"",consumable:!0,unique:!1,permanent:!1},e=new Map,n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:clone(t),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(_classCallCheck(this,n),!e||"string"!=typeof e)throw new Error("invalid item ID");if("object"!==_typeof(i))throw new Error("invalid item definition");Object.assign(this,Object.assign({},t,i)),this.id=e,this._tags=r instanceof Array?r:"string"==typeof r?[r]:[]}return _createClass(n,[{key:"tags",get:function(){return this._tags}},{key:"hasTag",value:function(t){return this._tags.includes(t)}},{key:"hasAllTags",value:function(){return this._tags.includesAll([].slice.call(arguments).flat(1/0))}},{key:"hasAnyTags",value:function(){return this._tags.includesAny([].slice.call(arguments).flat(1/0))}},{key:"name",get:function(){return this.displayName||this.id},set:function(t){this.displayName=t}},{key:"use",value:function(){return"string"==typeof this.handler?$.wiki(this.handler):"function"==typeof this.handler&&this.handler(this),this}},{key:"inspect",value:function(){return Dialog.setup(this.name,"simple-inventory item-description"),Dialog.wiki(this.description),Dialog.open(),this}}],[{key:"is",value:function(t){return t instanceof n}},{key:"add",value:function(t,i,r){var a=new n(t,i,r);return e.set(t,a),a}},{key:"get",value:function(t){return e.get(t)}},{key:"has",value:function(t){return e.has(t)}},{key:"list",get:function(){return e}}]),n}();setup.Item=n,window.Item=window.Item||n}(),function(){var t=setup.Item,e=!1,n="&hellip;",i={inspect:"Inspect",use:"Use",drop:"Drop",stack:"stack",take:"Take",give:"Give",stackPre:"&nbsp;&times;&nbsp;",stackPost:"&nbsp;"},r={};function a(e){return t.has(e)&&t.get(e).unique}var s=function(){function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_classCallCheck(this,s),this.data=clone(t),this._tags=e instanceof Array?e:"string"==typeof e?[e]:[]}return _createClass(s,[{key:"emit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s.emit(t,this,e),this}},{key:"array",get:function(){var t=this,e=[];return Object.keys(this.data).forEach((function(n){if(e.push(n),t.data[n]>1)for(var i=1;i<t.data[n];i++)e.push(n)})),e}},{key:"list",get:function(){return Object.keys(this.data)}},{key:"length",get:function(){return this.array.length}},{key:"uniqueLength",get:function(){return this.list.length}},{key:"table",get:function(){return this.data}},{key:"tags",get:function(){return this._tags}},{key:"hasTag",value:function(t){return this._tags.includes(t)}},{key:"hasAllTags",value:function(){return this._tags.includesAll([].slice.call(arguments).flat(1/0))}},{key:"hasAnyTags",value:function(){return this._tags.includesAny([].slice.call(arguments).flat(1/0))}},{key:"count",value:function(t){return t?this.data[t]||0:this.length}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.data[t]>=e}},{key:"hasAll",value:function(){var t=this;return[].slice.call(arguments).flat(1/0).every((function(e){return t.has(e)}))}},{key:"hasAny",value:function(){var t=this;return[].slice.call(arguments).flat(1/0).some((function(e){return t.has(e)}))}},{key:"compare",value:function(t){var e=this,n=s.itemset(t);return Object.keys(n).every((function(t){return e.has(t,n[t])}))}},{key:"merge",value:function(t){var e=this,n=s.itemset(t);return Object.keys(n).forEach((function(t){s.change(e,t,n[t])})),n}},{key:"unmerge",value:function(t){var e=this,n={},i=s.itemset(t);return Object.keys(i).forEach((function(t){e.has(t,i[t])?n[t]=i[t]:e.has(t)&&(n[t]=e.count(t)),s.change(e,t,i[t],!0)})),n}},{key:"pickup",value:function(){var t=this.merge(s.parseArgList.apply(null,arguments));return this.emit("update",{delta:t}),this}},{key:"drop",value:function(){var t=this.unmerge(s.parseArgList.apply(null,arguments));return this.emit("update",{delta:t}),this}},{key:"empty",value:function(){var t=clone(this.data);return this.data={},this.emit("update",{delta:t}),this}},{key:"transfer",value:function(t){var e=s.parseArgList.apply(null,[].slice.call(arguments).slice(1));if(!s.is(t))throw new TypeError("target inventory is not an inventory instance");var n=this.unmerge(e);return t.merge(n),this.emit("update",{target:t,delta:n}),this}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"iterate",value:function(t){var e=this;return"function"!=typeof t||this.list.forEach((function(n){t(n,e.data[n])})),this}},{key:"use",value:function(e){if(t.has(e)){var n=t.get(e);if(n.use(),n.consumable){s.change(this,e,1,!0);var i={};i[e]=1,this.emit("update",{delta:i})}return this.emit("use",{item:n}),this}}},{key:"clone",value:function(){return new s(this.data||{},this._tags||[])}},{key:"toJSON",value:function(){return JSON.reviveWrapper("new setup.Inventory("+JSON.stringify(this.data)+", "+JSON.stringify(this._tags)+")")}}],[{key:"confirm",get:function(){return e},set:function(t){e="string"==typeof t&&"all"===t.trim().toLowerCase()?"all":"string"==typeof t&&"stack"===t.trim().toLowerCase()?"stack":!!t}},{key:"emptyMessage",get:function(){return n},set:function(t){"string"==typeof t&&(n=t)}},{key:"strings",get:function(){return Object.assign(clone(i),r)},set:function(t){"object"===_typeof(t)&&(r=Object.assign(r,clone(t)))}},{key:"change",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(0!==i){if(e instanceof s&&(e=e.data),"object"!==_typeof(e)){if(e)throw new TypeError("cannot access inventory data");e={}}if(!(o=n)||"string"!=typeof o||!o.trim())throw new TypeError("invalid item name/id");var o;if("number"==typeof i&&!Number.isNaN(i)&&Number.isInteger(i)||(i=1),r&&(i*=-1),i>0){if(Object.keys(e).includes(n)&&a(n))return;i>1&&a(n)&&(i=1),Object.keys(e).includes(n)||(e[n]=0),e[n]+=i}else{if(function(e){return t.has(e)&&t.get(e).permanent}(n))return;Object.keys(e).includes(n)&&"number"==typeof e[n]&&(e[n]+=i),e[n]<=0&&delete e[n]}return e}}},{key:"itemset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s.is(t)&&(t=t.data),"object"!==_typeof(t))return{};var e={};return Object.keys(t).forEach((function(n){"number"==typeof t[n]&&Number.isInteger(t[n])&&0!==t[n]&&(e[n]=t[n])})),e}},{key:"parseArgList",value:function(){var t=[].slice.call(arguments).flat(1/0);if(t.length%2!=0)throw new Error("item sets should be pairs of item IDs and numbers");var e={};return t.forEach((function(n,i){i%2==0&&(e[n]=t[i+1])})),e}},{key:"is",value:function(t){return t instanceof s}},{key:"emit",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};$(document).trigger(Object.assign({type:":inventory-"+t+".simple-inventory",inventory:e,target:null,delta:{},item:null},n))}},{key:"create",value:function(t,e){return new s(t,e)}}]),s}();setup.Inventory=s,window.Inventory=window.Inventory||s}(),function(){var t=setup.Item,e=setup.Inventory;function n(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Alert",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Are you sure?";if(!t||"function"!=typeof t)throw new Error("Invalid confirmation callback!");if(e.confirm)if("all"!==e.confirm||"all"===i)if("stack"!==e.confirm||i){var s={display:"inline-block",float:"right"},o=$(document.createElement("div")),u=$(document.createElement("p")).append(a),l=$(document.createElement("div")).addClass("confirmation-buttons"),c=$(document.createElement("button")).append("Okay").addClass("confirm-yes").css(Object.assign(s,{"margin-right":"0.5rem"})),d=$(document.createElement("button")).append("Cancel").addClass("confirm-no").css(s);t&&"function"==typeof t&&c.ariaClick(t),n&&"function"==typeof n&&d.ariaClick(n),l.append(d,c),o.append(u,l),Dialog.setup(r,"simple-inventory confirmation"),Dialog.append(o),Dialog.open()}else t();else t();else t()}function i(t){var e=$(document.createElement("span")).addClass("spacer");return t&&e.wiki(""+t),e}function r(t,i){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return"give"===String(i).toLowerCase().trim()?i=e.strings.give:"take"===String(i).toLowerCase().trim()?i=e.strings.take:i&&"drop"!==String(i).toLowerCase().trim()||(i=e.strings.drop),$(document.createElement(r?"button":"a")).addClass("all-link drop-link").wiki(i+" all").ariaClick((function(){t.isEmpty()||n((function(){a&&e.is(a)?(a.merge(t),t.empty()):t.empty(),Dialog.close()}),(function(){Dialog.close()}),!0)}))}function a(a){var s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{description:!0,use:!0,transfer:null,drop:!0,all:!0,stack:!0,dropActionText:"",classes:""},u=$(document.createElement("ul")).addClass("simple-inventory-list");if(a.length){if(s=a.list.map((function(r){var s=[],u=r;t.has(r)&&(u=t.get(r).name),o.description&&t.has(r)&&t.get(r).description?s.push(function(n,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r=r||e.strings.inspect,$(document.createElement(a?"button":"a")).addClass("inspect-link").wiki(""+r).ariaClick((function(){t.get(i).inspect()}))}(a,r,u)):s.push($(document.createElement("span")).append(t.has(r)?t.get(r).name:r).addClass("item-name")),s.push(function(t,n,i,r){var a=$(document.createElement("span")),s=t.count(n);return i=i||e.strings.stackPre,r=r||e.strings.stackPost,1==s?a.addClass("item-count single"):a.addClass("item-count multi"),a.append(""+i+(s||0)+r)}(a,r)),o.use&&t.has(r)&&t.get(r).handler?s.push(function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return i=i||e.strings.use,$(document.createElement(r?"button":"a")).addClass("use-link").wiki(""+i).ariaClick((function(){t.use(n)}))}(a,r)):s.push(i()),(o.transfer&&e.is(o.transfer)||o.drop)&&!function(e){return t.has(e)&&t.get(e).permanent}(r)?(s.push(function(t,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"give"===String(r).toLowerCase().trim()?r=e.strings.give:"take"===String(r).toLowerCase().trim()?r=e.strings.take:r&&"drop"!==String(r).toLowerCase().trim()||(r=e.strings.drop),$(document.createElement(a?"button":"a")).addClass("drop-link").wiki(""+r).ariaClick((function(){n((function(){s&&e.is(s)?t.transfer(s,i,1):t.drop(i,1),Dialog.close()}),(function(){Dialog.close()}))}))}(a,r,o.dropActionText,!1,o.transfer||null)),a.count(r)>1&&o.stack?s.push(function(t,i,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"give"===String(r).toLowerCase().trim()?r=e.strings.give:"take"===String(r).toLowerCase().trim()?r=e.strings.take:r&&"drop"!==String(r).toLowerCase().trim()||(r=e.strings.drop),r=r+"&nbsp;"+e.strings.stack,$(document.createElement(a?"button":"a")).addClass("stack-link drop-link").wiki(""+r).ariaClick((function(){n((function(){s&&e.is(s)?t.transfer(s,i,t.count(i)):t.drop(i,t.count(i)),Dialog.close()}),(function(){Dialog.close()}))}))}(a,r,o.dropActionText,!1,o.transfer||null)):s.push(i())):s.push(i());var l=r.normalize().toLowerCase().replace(/\s+/g,"-");return $(document.createElement("li")).append(s).addClass("simple-inventory-listing").attr({"data-item-id":l,"data-keyword":u})})),o.all){var l=$(document.createElement("li")).addClass("all-listing simple-inventory-listing").append([i("&mdash;"),i(),i(),r(a,o.dropActionText,!1,o.transfer||null)]);s.push(l)}}else s=$(document.createElement("li")).addClass("simple-inventory-listing").append($(document.createElement("span")).wiki(e.emptyMessage));return u.append(s),u}e.prototype.interface=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this,r=$(document.createElement("div")).addClass("simple-inventory-wrapper");return e.filter&&r.append(function(){var t=$(document.createElement("div")).addClass("simple-inventory-filter"),e=$(document.createElement("input")).attr({type:"text",placeholder:"Filter..."}).on("input",(function(){var n=e.val().trim().toLowerCase(),i=t.parent().find("ul.simple-inventory-list li.simple-inventory-listing:not(.all-listing)");n?i.each((function(t,e){var i=$(e);i&&i.length&&(i.attr("data-keyword").substring(0,n.length).trim().toLowerCase()!==n?i.hide():i.show())})):i.show()}));return t.append(e),t}()),r.append(a(this,e)),$(document).on(":inventory-update.simple-inventory.gui-built-in",(function(){r.length?r.empty().append(a(i,e)):$(document).off(":inventory-update.simple-inventory.gui-built-in")})),n&&n instanceof $?t=n:n&&(t=$(n)),t&&r.appendTo(t),r}}(),function(){setup.Inventory,setup.Item;var t=".simple-inventory-userland",e=":inventory-update.simple-inventory"+t,n=":inventory-use.simple-inventory"+t;function i(t){return t&&"function"==typeof t}Object.assign(setup.Inventory,{events:{update:{on:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).on(e+n,t)},one:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).one(e+n,t)},off:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$(document).off(e+t)}},use:{on:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).on(n+e,t)},one:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i(t)&&$(document).one(n+e,t)},off:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";$(document).off(n+t)}}}})}(),function(){var t=":";function e(e){var n=function(t){return t.replace(/\r+/g,"\n").replace(/\n+/,"\n").replace(/ +/g," ").trim().split(/\n/g)}(e),i={};return n.forEach((function(e){if(e&&e.trim()&&e.includes(t)){var n=e.trim().split(t);i[n[0].trim()]=n[1].trim()}})),i}var n=function(t){try{return Story.has(t)?e(Story.get(t).text):{}}catch(t){return console.error(t.message,t),{}}}("inventory.strings");n.empty&&"string"==typeof n.empty&&n.empty.trim()&&(setup.Inventory.emptyMessage=n.empty,delete n.empty),setup.Inventory.strings=n||{}}(),function(){var t=setup.Item,e=setup.Inventory;function n(t){return t&&"string"==typeof t&&t.length>=2&&("$"===t[0]||"_"===t[0])}function i(t){if(n(t)&&(t=State.getVar(t)),e.is(t))return t}Macro.add(["item","consumable"],{tags:["description","tags","unique","permanent"],handler:function(){var e,n,i,r,a=null,s=!1,o=!1,u=!1;if(State.length>0)return this.error("items must be defined in `StoryInit` or story JavaScript!");if(!this.args[0]||"string"!=typeof this.args[0]||!this.args[0].trim())return this.error("invalid item ID");if(e=this.args[0].trim(),"consumable"===this.name&&(a=this.payload[0].contents||null,s=!0),this.args[1]&&(n=this.args[1]),this.payload.length>1){var l=this.payload.find((function(t){return"description"===t.name})),c=this.payload.find((function(t){return"tags"===t.name})),d=this.payload.find((function(t){return"unique"===t.name})),f=this.payload.find((function(t){return"permanent"===t.name}));l&&(i=l.contents.trim()),c&&(r=c.args.flat(1/0)),d&&(o=!0),f&&(u=!0)}t.add(e,{displayName:n||"",description:i||"",handler:a,consumable:s,unique:o,permanent:u},r)}}),Macro.add("newinv",{handler:function(){var t=this.args.raw.trim().split(" ").first().replace(/["']/g,"").trim();if(!n(t))return this.error("argument must be a story or temporary variable!");State.setVar(t,new e({},this.args.flat(1/0).slice(1)))}}),Macro.add(["pickup","drop"],{handler:function(){var t=i(this.args[0]);return t?this.args.length<3?this.error("no items to pick up were provided"):void t[this.name](this.args.slice(1)):this.error("first argument must be a valid inventory!")}}),Macro.add("dropall",{handler:function(){var t=i(this.args[0]);if(!t)return this.error("first argument must be a valid inventory!");t.empty()}}),Macro.add(["transfer","merge","unmerge"],{handler:function(){var t=i(this.args[0]);if(!t)return this.error("first argument must be a valid inventory!");var e=i(this.args[1]);if(!e)return this.error("second argument must be a valid inventory!");if("transfer"===this.name){if(this.args.length<4)return this.error("no items to transfer were provided");t.transfer(e,this.args.slice(2))}else t[this.name](e)}}),Macro.add(["inv","take","give"],{handler:function(){var t=null,n=i(this.args[0]);if(!n)return this.error("first argument must be a valid inventory!");this.args[1]&&i(this.args[1])&&(t=i(this.args[1]));var r={description:this.args.includesAny("inspect","description"),use:this.args.includes("use"),transfer:t,drop:this.args.includes("drop"),all:this.args.includes("all"),stack:this.args.includes("stack"),filter:this.args.includes("filter"),dropActionText:"inv"===this.name?"Drop":e.strings[this.name.trim().toLowerCase()],classes:"macro-".concat(this.name)};n.interface(r,$(this.output))}})}(),function(){var t=setup.Item,e=setup.Inventory;function n(t,e,n){if("object"!==_typeof(e))throw new TypeError("the extension should be a plain generic object holding the properties and methods you want to add");Object.keys(e).forEach((function(i){if(t[i]&&!n)throw new Error('Cannot override existing property "'+i+'"!');t[i]=e[i]}))}Object.assign(e,{extend:function(t){n(e,t,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},extendPrototype:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n(e.prototype,t,i)}}),Object.assign(t,{extend:function(e){n(t,e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},extendPrototype:function(e){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n(t.prototype,e,i)}})}();
// End Simple Inventory

window.generateConfetti = function (config, canvasId = "vanillaConfettiCanvas") {
	const canvas = document.querySelector(`#${canvasId}`);
	if (!canvas) return console.error(`Canvas with id "${canvasId}" not found.`);
	const ctx = canvas.getContext("2d");
	const confetti = [];

	function resizeCanvas() {
		canvas.width = window.innerWidth;
		canvas.height = window.innerHeight;
	}

	function drawParticle(p) {
		ctx.save();
		ctx.translate(p.x, p.y);
		ctx.rotate(p.rotation * Math.PI / 180);
		ctx.scale(1, Math.cos(p.rotation * Math.PI / 180));
		ctx.fillStyle = p.color;

		if (p.shape === 0) {
			ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);
		} else if (p.shape === 1) {
			ctx.beginPath();
			ctx.arc(0, 0, p.size / 2, 0, 2 * Math.PI);
			ctx.fill();
		} else {
			ctx.beginPath();
			ctx.moveTo(-p.size / 2, p.size / 2);
			ctx.lineTo(p.size / 2, p.size / 2);
			ctx.lineTo(p.size / 4, -p.size / 2);
			ctx.lineTo(-p.size / 4, -p.size / 2);
			ctx.closePath();
			ctx.fill();
		}

		ctx.restore();
	}

	resizeCanvas();
	window.addEventListener("resize", resizeCanvas);

	(function initParticles() {
		for (let i = 0; i < config.quantity; i++) {
			confetti.push({
				x: Math.random() * canvas.width,
				y: Math.random() * canvas.height - canvas.height,
				size: Math.random() * (config.maxSize - config.minSize) + config.minSize,
				color: config.colorsArray[Math.floor(Math.random() * config.colorsArray.length)],
				velocityX: 2 * Math.random() - 1,
				velocityY: 3 * Math.random() + 2,
				rotation: 360 * Math.random(),
				rotationSpeed: 10 * Math.random() - 5,
				shape: Math.floor(3 * Math.random()),
				depth: 3 * Math.random()
			});
		}
	})();

	(function animate() {
		ctx.clearRect(0, 0, canvas.width, canvas.height);
		for (let p of confetti) {
			p.velocityY += config.velocity;
			p.x += 0.5 * Math.sin(p.y / 30);
			p.rotation += p.rotationSpeed;
			p.x += p.velocityX;
			p.y += p.velocityY;

			if (p.y > canvas.height) {
				if (config.infiniteLoop) {
					p.y = -10;
					p.x = Math.random() * canvas.width;
					p.velocityY = 3 * Math.random() + 2;
					p.size = Math.random() * (config.maxSize - config.minSize) + config.minSize;
					p.color = config.colorsArray[Math.floor(Math.random() * config.colorsArray.length)];
					p.depth = 3 * Math.random();
					p.rotation = 360 * Math.random();
				} else {
					confetti.splice(confetti.indexOf(p), 1);
				}
			}

			ctx.globalAlpha = (1 - p.depth / 3) * config.minOpacity + Math.random() * (config.maxOpacity - config.minOpacity);
			drawParticle(p);
		}
		ctx.globalAlpha = 1;
		requestAnimationFrame(animate);
	})();
};


:: StoryStylesheet [stylesheet]
/* twine-user-stylesheet #1: "StoryStylesheet" */
/* twine-user-stylesheet #1: "StoryStylesheet" */
/* twine-user-stylesheet #1: "StoryStylesheet" */

/* Simple Inventory, for SugarCube 2, by Chapel
v3.0.1, 2024-07-22, 8c9749dbafa5f12948d743a8dedd4e1c74bb9e26 */
ul.simple-inventory-list{margin:0 auto;padding:0}.simple-inventory-listing{list-style:none;padding:.3rem .3rem .3rem 1rem;display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr}.simple-inventory-listing:nth-child(2n){background-color:#000}.simple-inventory-listing>a,.simple-inventory-listing>span{display:inline-block}.all-listing.simple-inventory-listing{border-top:1px solid #fafafa;background-color:transparent}.drop-link{color:#e33}.drop-link:active,.drop-link:focus,.drop-link:hover{color:#f88}.simple-inventory-filter{text-align:right}.simple-inventory-filter input{display:inline-block}
/* End Simple Inventory */

@font-face {
  font-family: 'Signika';
  src: url('fonts/Signika-Medium.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'Caveat';
  src: url('fonts/Caveat.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'Dot';
  src: url('fonts/Dot.otf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'Lissa';
  src: url('fonts/PlaywriteHU-Regular.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'ASL';
  src: url('fonts/ASL.otf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

body {
  font-family: 'Signika', sans-serif;
  text-align: center;
}


@font-face {
	font-family: "NotoEmoji";
	src: url("fonts/NotoEmoji.ttf") format("truetype");
}

.emojifont {
	font-family: "NotoEmoji", sans-serif;
	font-size: 2em;
}

.row {
  margin: 0;
  padding: 0;
  min-height: 120px;
  border: double;
  display: flex;
  overflow: hidden;
  box-sizing: border-box;
}



/* No need for float anymore; flex handles layout */
.iconcolumn {
  width: 100px;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* Dialogue column fills the rest of the space */
.dialoguecolumn {
  flex: 1;
  display: flex;
  align-items: center;
  text-align: left;
  padding-left: 10px;
}

#dialogueContainer {
  margin: 0;
  padding: 0;
  min-height: 130px;
}


/* Optional: make sure image doesn't overflow */
.iconcolumn img {
  max-width: 100%;
  max-height: 100%;
  display: block;
}




/*Backgrounds*/

tw-story.dome-bg {
  background-color: rgb(124, 184, 159);
}

tw-story.metis-bg {
  background-color: rgb(61, 86, 61);
}

tw-story.snow-bg {
  background-color: rgb(209, 212, 215);
}

body[data-tags~="wood"] {
	background-image: url("images/wood.jpg");
	background-repeat: no-repeat;
	background-size: cover;
}


.say {
    border: 2px solid #eee;
    overflow: auto;
}

.say > img {
    max-width: 20%;
    float: left;
    margin-right: 1em;
}

.say > p:first-of-type {
    font-weight: bold;
    margin: 0.2em 0;
}

.say > p:last-of-type {
    padding: 0.5em;
    margin: 0;
}

/* dialogue effects */

.vibrate {
  display: inline-block;
  animation: vibrate 0.1s infinite;
}

@keyframes vibrate {
  0%   { transform: translate(0px, 0px); }
  25%  { transform: translate(1px, -1px); }
  50%  { transform: translate(-1px, 1px); }
  75%  { transform: translate(1px, 1px); }
  100% { transform: translate(-1px, -1px); }
}

.wave {
  display: inline-block;
  animation: wave 1.2s infinite ease-in-out;
}

@keyframes wave {
  0%, 100% { transform: translateY(0); }
  25% { transform: translateY(-3px); }
  50% { transform: translateY(3px); }
  75% { transform: translateY(-2px); }
}

.tilt {
  display: inline-block;
  animation: tilt 1.5s infinite linear;
  transform-origin: center;
}

@keyframes tilt {
  0%   { transform: rotateY(0deg); }
  50%  { transform: rotateY(180deg); }
  100% { transform: rotateY(360deg); }
}

.blink {
  animation: blink 1s steps(2, start) infinite;
}

@keyframes blink {
  to { visibility: hidden; }
}

.pulse {
  animation: pulse 1.5s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50%      { transform: scale(1.1); }
}

/* UI */

#story-title {
  font-size: medium;
}

#story-caption {
  font-size: small;
}



.lissafont {
	font-family: 'Lissa', cursive;
	font-size: 1.2em;
}


.dotfont {
	font-family: 'Dot', cursive;
	font-size: 2em;
	margin-top: 1em;
}

.asl {
	font-family: 'ASL';
	font-size: 3em;
}

.caveat {
	font-family: 'caveat';
	font-size: 3em;
}

a:link {
  font-weight: bold;
  font-size: 1.2em;
  transition: color 0.3s ease;  
}

    a:visited {
      color: purple;
    }
    a:hover {
      color: skyblue;
    }